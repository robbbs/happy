"use strict";angular.module("well",["ngRoute","ngAnimate","well.controllers","well.filters","well.services","well.directives","well.survey","well.tradeoff","well.overlap","well.instruct","well.results","well.instruct","well.modular","well.admin"]).config(["$routeProvider","$locationProvider",function(t){t.when("/",{templateUrl:"landing.html"}).when("/auth",{templateUrl:"auth.html"}).when("/consent",{templateUrl:"consent.html"}).when("/terms",{templateUrl:"terms.html"}).when("/privacy",{templateUrl:"privacy.html"}).when("/:module/survey",{templateUrl:"survey.html",controller:"SurveyCtrl"}).when("/sur",{templateUrl:"survey.html",controller:"SurveyCtrl"}).when("/transition",{templateUrl:"transition.html",controller:"TransCtrl"}).when("/:module/instruct",{templateUrl:"instructions.html",controller:"InstructCtrl"}).when("/:module/instructions",{templateUrl:"instruct.html",controller:"InstructorCtrl"}).when("/threetwo/abbcca",{templateUrl:"tradeoff.html",controller:"ThreeCtrl"}).when("/threetwo/dbec",{templateUrl:"tradeoff.html",controller:"TwoCtrl"}).when("/overlap/transition",{templateUrl:"transition.html",controller:"TransCtrl"}).when("/overlap/abac",{templateUrl:"tradeoff.html",controller:"AbacCtrl"}).when("/overlap/abc",{templateUrl:"overlap.html",controller:"AbcCtrl"}).when("/fineoverlap/tradeoff",{templateUrl:"fineoverlap.html",controller:"FineCtrl"}).when("/module/config",{templateUrl:"config.html",controller:"ConfigCtrl"}).when("/module/:name/rating",{templateUrl:"rating.html",controller:"RatingCtrl"}).when("/module/:name/tradeoff",{templateUrl:"modulartradeoff.html",controller:"TradeoffCtrl"}).when("/:module/exit",{templateUrl:"exit.html",controller:"ExitCtrl"}).when("/chart",{templateUrl:"chart.html",controller:"ChartCtrl"}).when("/dummy",{templateUrl:"dummy.html",controller:"DummyCtrl"}).when("/test",{templateUrl:"test.html",controller:"TestCtrl"}).when("/admin/dashboard",{templateUrl:"admin.html",controller:"AdminCtrl"}).when("/anon",{templateUrl:"landing.html",resolve:{login:["User",function(t){return t.loginAnon()}]}}).otherwise({redirectTo:"/"})}]).run(["User","$location","$http",function(t,e,l){t.isAuthed()||-1===e.path().indexOf("/admin")||e.path("/"),l.post("api/survey/generate",{aspects:[{text:"Health",rating:72},{text:"Meaning",rating:79},{text:"Worthwhileness",rating:76}],combinations:[{type:"pairwise",indices:[0,1]},{type:"pairwise",indices:[0,2]},{type:"overlap",indices:[0,1,2]}]}).success(function(t){console.log(t)}).error(function(t){console.log(t)})}]);
"use strict";angular.module("well.controllers",[]).controller("AppCtrl",["$scope","$rootScope","$timeout","User","$location","Aspects","Survey","Font",function(n,e,o,i,l,s,a,r){n.font=r,n.aspects={texts:s.texts},e.$on("auth",function(){s.names().then(function(e){return n.aspects.names=e}),i.getFontSize().then(function(n){return r.setSize(n)})}),a.getResponses(),n.responses=a.responses,n.user=i,i.isAdmin().then(function(e){n.isAdmin=e}),n.settings={devmode:!1,instruct:!0},n.landing={url:"preamble.html"},n.loc=l,n.login={wrong:!1,placeholder:{email:"Enter your email",password:"Password"},submit:function(){n.login.email?n.login.password?i.login(this.email,this.password).then(function(e){n.login.wrong="in",console.log("Logged in as: ",e.uid),n.landing.url="modules.html"},function(e){n.login.wrong=e.code,"INVALID_EMAIL"===e.code?(n.login.email="",n.login.placeholder.email="Enter a valid email"):"INVALID_PASSWORD"===e.code&&(n.login.password="",n.login.placeholder.password="Enter a valid password"),console.error("Login failed: ",e)}):(n.login.wrong="INVALID_PASSWORD",n.login.placeholder.email="Enter a valid password"):(n.login.wrong="INVALID_EMAIL",n.login.placeholder.email="Enter a valid email")},reset:function(){n.login.email?(n.login.message=n.login.alert="",i.reset(n.login.email).then(function(){n.login.wrong="",n.login.message="We have sent an email with instructions to reset your password"},function(e){n.login.alert=e.message})):(n.login.wrong="INVALID_EMAIL",n.login.placeholder.email="Enter a valid email")}},n.signup={wrong:!1,placeholder:{email:"Enter your email",password:"Password",confirm:"Confirm password"},submit:function(){if(n.signup.email)if(n.signup.password)if(n.signup.password&&n.signup.password&&n.signup.password!==n.signup.confirm)n.signup.wrong="mismatch",n.signup.confirm="";else{i.signup(n.signup.email,n.signup.password).then(function(){o(function(){return n.landing.url="terms.html"})},function(e){console.log(e),n.signup.wrong=e.code,"INVALID_EMAIL"===e.code?(n.signup.email="",n.signup.placeholder.email="Enter a valid email"):"INVALID_PASSWORD"===e.code?(n.signup.password="",n.signup.placeholder.password="Enter a valid password"):"EMAIL_TAKEN"===e.code&&(n.signup["false"]=!0,alert("The specified email address is already in use.")),console.error("Sign up failed: ",e)})}else n.signup.wrong="INVALID_PASSWORD",n.signup.placeholder.email="Enter a valid password";else n.signup.wrong="INVALID_EMAIL",n.signup.placeholder.email="Enter a valid email"},agree:function(){i.login(n.signup.email,n.signup.password).then(function(e){n.login.wrong="in",console.log("Logged in as: ",e.uid),n.landing.url="modules.html"},function(n){console.log(n)})}},n.terms={agree:function(){i.info&&"anonymous"===i.info.provider?(n.landing.url="modules.html",n.terms.agreed=!0):(n.terms.agreed=!0,i.login(n.signup.email,n.signup.password).then(function(e){n.login.wrong="in",console.log("Logged in as: ",e.uid),n.landing.url="modules.html"},function(n){console.log(n)}))}},n.cue={option:null,deltaOne:0,deltaTwo:0}}]).controller("DummyCtrl",["$scope",function(n){var e=["Following your passion","Being acknowledged for your work","Being treated fairly","Having meaningful relationships","Having a sense of purpose"];n.pairs=_.map(e,function(n,o){return[n,e[(o+1)%5]]}),n.levels={},_.each(e,function(e){n.levels[e]=Math.round(35*Math.random()+60)}),n.selections={},console.log(n.pairs,n.levels)}]);
"use strict";angular.module("well.directives",[]).directive("earth",["$window","Aspects",function(t){return{restrict:"EA",scope:{},link:function(e){window.onresize=function(){e.$apply()},e.$watch(function(){return angular.element(t)[0].innerWidth},function(){e.render()});var r=d3.select(".splash");e.render=function(){r.selectAll(".earth *").remove();{var t=window.innerWidth,n=window.innerHeight,a=d3.geo.orthographic().precision(0).scale(500).translate([t/2,n/2]).clipAngle(180),i=d3.select(".splash .earth").append("canvas").attr("width",t).attr("height",n),l=i.node().getContext("2d"),o=d3.geo.path().projection(a).context(l);d3.random.logNormal(1)}_.each(e.responses,function(t){t.rand=20*Math.random()+10}),d3.json("world-110m.json",function(e,r){function i(){a.rotate([.1*d,.1*c,30]),l.clearRect(0,0,t,n),_.each(s,function(t){l.beginPath(),l.strokeStyle=d3.hsl(t.properties.color*d,1,.8).toString(),o(t),l.stroke()})}var d,c=0;window.onscroll=function(){c=(window.pageYOffset||document.scrollTop)-(document.clientTop||0)||0,i()},d3.select("body").on("mousemove",function(){d=d3.mouse(this)[0],i()});var s=(topojson.feature(r,r.objects.land),topojson.feature(r,r.objects.countries).features);_.each(s,function(t){t.properties.color=Math.random()}),i()})}}}}]).directive("range",["$window","$timeout","Aspects",function(t,e){return{restrict:"EA",scope:{level:"="},link:function(r,n){var a=d3.select(n[0]).append("svg").attr("width","100%").attr("height",22);window.onresize=function(){r.$apply()},r.$watch(function(){return angular.element(t)[0].innerWidth},function(){r.render()});var i=null;r.$watch("level",function(t){t!==i&&r.render()}),r.render=function(){function t(){var t=c.extent()[0],n=d.invert(d3.mouse(this)[0]);t=isNaN(n)?t:n,c.extent([t,t]),t&&(t=Math.round(t)),v.style("display","block").attr("d",h(p().set(d(t)))+"Z"),i=t,e(function(){r.level=t})}a.selectAll("*").remove();var l=d3.select(n[0])[0][0].offsetWidth,o=22,d=d3.scale.linear().domain([0,10]).range([6,l-6]).clamp(!0),c=d3.svg.brush().x(d).extent([r.level,r.level]).on("brush",t),s=a.append("g").attr("class","axis");s.call(d3.svg.axis().scale(d).orient("bottom").tickSize(0).tickValues([]));var f=s.select(".domain").attr("transform","translate(0, 10)");f.select(function(){return this.parentNode.appendChild(this.cloneNode(!0))}).attr("class","halo");var u=a.append("g").attr("class","slider").call(c);u.selectAll(".extent,.resize").remove(),u.select(".background").attr("height",o);var p=function(){var t=d(1),e=10;return{set:function(r){return t=r,[{x:t-6,y:e-6},{x:t+6,y:e-6},{x:t+6,y:e+6},{x:t,y:e+10},{x:t-6,y:e+6}]}}},h=d3.svg.line().x(function(t){return t.x}).y(function(t){return t.y}),v=u.append("path").attr("class","handle").attr("d",h(p().set(d(r.level)))+"Z").style("display","none")}}}}]).directive("bar",["$window","Aspects","$filter",function(t,e){return{restrict:"E",scope:{level:"=",name:"=",resize:"="},link:function(r,n){var a=d3.select(n[0]).append("svg").attr("width","100%").attr("height",50),i=a.append("g");window.onresize=function(){r.$apply()},r.$watch("level",function(){r.render()}),r.$watch("name",function(){r.render()}),r.$watch("resize",function(){console.log("resize",r.resize),r.render()}),r.$watch(function(){return angular.element(t)[0].innerWidth},function(){r.render()}),r.render=function(){i.selectAll("*").remove();var t=d3.select(n[0])[0][0].offsetWidth,a=t>0?t:100,l=40,o=d3.scale.linear().domain([0,10]).range([6,a-6]),d=i.append("g").attr("class","axis").attr("transform","translate(0,"+(l-20)+")");d.call(d3.svg.axis().scale(o).orient("bottom").tickSize(0).tickPadding(12)),d.select(".domain").remove();var c=(i.append("rect").attr("class","backbar").attr("x",o(0)).attr("y",4).attr("height",20).attr("width",o(100)-o(0)),i.append("rect").attr("class","barBack").attr("x",o(0)).attr("y",4).attr("height",20).attr("width",o(100)-o(0)).style("fill","#eee"),i.append("rect").attr("class","bar").attr("x",o(0)).attr("y",4).attr("height",20).attr("width",o(r.level)-o(0)).style("fill",e.getColor(r.name,100)),i.append("text").attr("class","text").attr("y",14).attr("dy",".375em").style("fill","#000").style("font-weight","400"),o(r.diff?r.level+r.diff:r.level));r.level&&i.append("line").attr("x1",c).attr("y1",4).attr("x2",c).attr("y2",24).style("stroke","#000")}}}}]).directive("diff",["$window","Aspects","$filter","$timeout","Survey",function(t,e,r,n){return{restrict:"E",scope:{level:"=",diff:"=",name:"=",choice:"=",animate:"=",delta:"=",option:"@"},link:function(t,a){var i,l=a[0].parentNode.getBoundingClientRect().width,o=d3.select(a[0]).append("svg").attr("width",l).attr("height",180),d=o.append("g").attr("transform","translate(0,30)");window.addEventListener("resize",function(){t.render(!0)}),t.$watch("level",function(){t.render()}),t.$watch("diff",function(){t.render()}),t.$watch("name",function(){t.render()});var c=2e3,s=1e3;t.$watch("animate",function(){console.log("animate",t.animate),t.name&&t.animate&&t.render(!0)});var f=0,u=0,p=[0,100],h=d3.select(a[0]).append("div").attr("class","scale");h.append("span").text("0").attr("class","left"),h.append("span").text("100").attr("class","right"),t.render=function(h){l=a[0].parentNode.getBoundingClientRect().width,o.attr("width",l),d.selectAll("*").remove(),i&&i.remove(),l-=30;var v=42,w=d3.scale.linear().domain(p).range([21,l-6]);if(w(p[1])-w(p[0])>0)var m=(d.append("rect").attr("class","backbar").attr("x",w(p[0])).attr("y",v+4).attr("height",20).attr("width",w(p[1])-w(p[0])),d.append("rect").attr("class","barBack").attr("x",w(p[0])).attr("y",v+4).attr("height",20).attr("width",w(p[1])-w(p[0])).style("fill","#eee"),d.append("rect").attr("class","bar").attr("x",w(p[0])).attr("y",v+4).attr("height",20).attr("width",w(t.level)-w(p[0])).style("fill",e.getColor(t.name,100)));var g=(d.append("rect").attr("class","diff").attr("y",v+4).attr("height",20).style("fill",e.getColor(t.name,205)),function(t,e,r){return r+=v,"M"+w(t)+" "+Number(r+2)+" L"+Number(w(e)-4)+" "+Number(r+2)+" L"+Number(w(e)-4)+" "+r+" L"+w(e)+" "+Number(r+3)+" L"+Number(w(e)-4)+" "+Number(r+6)+" L"+Number(w(e)-4)+" "+Number(r+4)+" L"+w(t)+" "+Number(r+4)+" Z"}),y=function(t,e,r){return r+=v,"M"+w(t)+" "+Number(r+2)+" L"+Number(w(e)+4)+" "+Number(r+2)+"L"+Number(w(e)+4)+" "+r+" L"+w(e)+" "+Number(r+3)+" L"+Number(w(e)+4)+" "+Number(r+6)+"L"+Number(w(e)+4)+" "+Number(r+4)+" L"+w(t)+" "+Number(r+4)+" Z"},x=(d.append("path").attr("class","arrow").attr("stroke","none").style("fill","#000"),d.append("text").attr("class","text").attr("y",v+14).attr("dy",".375em").style("fill","#000").style("font-weight","400")),b=w(t.diff?t.level+t.diff:t.level);if(t.level&&d.append("line").attr("x1",b).attr("y1",v+4).attr("x2",b).attr("y2",v+24).style("stroke","#000"),h){if(t.diff){var $=w(12)-w(0);i=o.select(function(){return this.appendChild(this.cloneNode(!0))}).attr("class","zoom");var N="clip"+Math.random().toString().replace(".",""),k=i.append("defs").append("clipPath").attr("id",N);k.append("circle").attr("cx",b).attr("cy",2*v).attr("r",$),i.insert("circle","g").attr("cx",b).attr("cy",2*v).attr("r",$).style("fill","#fff"),i.append("circle").attr("cx",b).attr("cy",2*v).attr("r",$).style("fill","none").style("stroke","#000").style("stroke-width","2px");var A=o[0][0].getBoundingClientRect();i.attr("viewBox",b/2+" "+Number(v/2+20)+" "+A.width/2+" "+A.height/2).attr("clip-path","url(#"+N+")").transition().delay(1300).duration(s).attr("viewBox","0 0 "+A.width+" "+A.height).each("end",function(){return i.remove()}),m.style("fill-opacity","0.6").transition().delay(1300).duration(s).style("fill-opacity","1"),d3.transition().delay(300).duration(c).tween("diff",function(){var e=d3.interpolateRound(0,t.diff);return function(r){n(function(){return t.delta=e(r)})}})}if(t.diff>0){u=t.diff,f=w(t.diff)-w(0),o.selectAll(".diff").attr("x",w(t.level)).attr("width",0).transition().delay(300).duration(c).attr("width",f),o.selectAll(".arrow").attr("d",g(t.level,t.level,11)).transition().delay(300).duration(c).attr("d",g(t.level,t.level+t.diff,11)),o.selectAll(".text").text("+"+r("round1")(t.diff));{x.style("width").replace("px","")}o.selectAll(".text").attr("text-anchor","start").attr("x",w(t.level+t.diff)).attr("dx",4)}else t.diff<0?(u=t.diff,f=w(-t.diff)-w(0),o.selectAll(".diff").attr("x",w(t.level)).attr("width",0).style("fill",e.getColor(t.name,40)).transition().delay(300).duration(c).attr("x",w(t.level)-f).attr("width",f),o.selectAll(".arrow").attr("d",y(t.level,t.level,11)).transition().delay(300).duration(c).attr("d",y(t.level,t.level+t.diff,11)),o.selectAll(".text").text(r("round1")(t.diff)),o.selectAll(".text").attr("text-anchor","end").attr("dx",-4).attr("x",w(t.level+t.diff))):u>0?(f=w(u)-w(0),o.selectAll(".diff").attr("x",w(t.level)).attr("width",f).transition().duration(c).attr("width",0)):0>u&&(f=w(-u)-w(0),o.selectAll(".diff").attr("x",w(t.level)-f).attr("width",f).style("fill",e.getColor(t.name,40)).transition().delay(300).duration(c).attr("x",w(t.level)).attr("width",0))}}}}}]).directive("fix",["$window",function(t){return{restrict:"EA",scope:{},link:function(e,r){var n=d3.select(r[0]),a=d3.select(n[0][0].parentNode);window.onresize=function(){e.$apply()},e.$watch(function(){return angular.element(t)[0].innerWidth},function(){e.render()}),e.render=function(){var t=a[0][0].getBoundingClientRect();n.style({position:"fixed",padding:a.style("padding"),top:window.scrollTop?t.top+window.scrollTop+"px":t.top+"px",left:window.scrollLeft?t.left+window.scrollLeft+"px":t.left+"px",width:t.width+"px"})}}}}]).directive("prog",["$window",function(t){return{restrict:"EA",scope:{complete:"="},link:function(e,r){var n=d3.select(r[0]).append("svg").attr("width","100%").attr("height",8);window.onresize=function(){e.$apply()},e.$watch(function(){return angular.element(t)[0].innerWidth},function(){e.render()}),e.$watch("complete",function(){e.render()}),e.render=function(){n.selectAll("*").remove();var t=n[0][0].getBoundingClientRect();n.append("rect").attr("height",8).attr("width",t.width*e.complete).attr("fill","#559")}}}}]).directive("back",["Aspects",function(t){return{restrict:"EA",scope:{name:"="},link:function(e,r){e.$watch("name",function(e){r[0].style.border="1px solid "+t.getColor(e,60)})}}}]).directive("onEnter",function(){return{scope:{onEnter:"&"},link:function(t,e){console.log(t),e.bind("keyup",function(e){13===e.which&&(t.onEnter(),t.$apply())})}}});
"use strict";angular.module("well.filters",[]).filter("round2",function(){return function(r){return Number(r).toFixed(2)}}).filter("round1",function(){return function(r){return r%1===0?r:Number(r).toFixed(1)}}).filter("percent",function(){return function(r){return d3.format("%")(r)}}).filter("capitalize",function(){return function(r){return r?r.charAt(0).toUpperCase()+r.slice(1):""}}).filter("duration",function(){return function(r){var n=Math.round(r/1e3);return 10>n?"0:0"+n:"0:"+n}}).filter("JSONify",function(){return function(r){return angular.toJson(r,2)}}).filter("alphabetize",function(){return function(r){return String.fromCharCode(r+97)}}).filter("greekify",function(){return function(r){var n=r.charCodeAt(0);return unescape("%u0"+(848+n).toString(16))+r.substring(1)}}).directive("comma",function(){return{require:"ngModel",link:function(r,n,t,e){e.$parsers.unshift(function(r){return r.split(/\s*,\s*/g)})}}});
"use strict";angular.module("well.services",[]).factory("User",["$q","$rootScope","$location","$timeout",function(e,t,i,n){var o=this,r=this;return this.firebase=new Firebase("https://well.firebaseio.com/"),this.info=this.firebase.getAuth(),this.isAuthed=function(){return!!o.firebase.getAuth()},this.hashedEmail=function(e){return"wiaglif+"+CryptoJS.SHA3(e,{outputLength:224}).toString()+"@gmail.com"},this.signup=function(t,i){var n=e.defer();return o.email=t,o.firebase.createUser({email:t,password:i},function(e){null===e?(console.log("User created successfully"),n.resolve()):(console.log("Error creating user:",e),n.reject(e))}),n.promise},this.login=function(t,i){var s=e.defer();return o.email=t,o.firebase.authWithPassword({email:t,password:i},function(e,t){null===e?(n(function(){r.info=t}),console.log("User ID: "+t.uid+", Provider: "+t.provider),s.resolve(t)):(console.log("Error authenticating user:",e),s.reject(e))}),s.promise},this.loginAnon=function(){var t=e.defer();return o.firebase.authAnonymously(function(e,i){e?(console.log("Error authenticating user:",e),t.reject(e)):(n(function(){console.log(i),r.info=i}),console.log("User ID: "+i.uid+", Provider: "+i.provider),t.resolve(i))}),t.promise},this.reset=function(t){var i=e.defer();return o.email=t,o.firebase.resetPassword({email:t},function(e){e?i.reject(e):i.resolve()}),i.promise},this.firebase.onAuth(function(e){n(function(){t.$broadcast("auth"),r.info=e})}),this.unauth=function(){o.firebase.unauth(),r.info=null,window.location.href=window.location.href.split("#")[0]},this.setAspects=function(e){o.firebase.onAuth(function(t){t&&r.firebase.child("aspects/"+t.uid).set(e,function(){return r.aspects=e})})},this.getAspects=function(){var t=e.defer();return o.aspects?t.resolve(o.aspects):o.firebase.onAuth(function(e){e&&r.firebase.child("aspects/"+e.uid).on("value",function(e){r.aspects=e.val(),t.resolve(e.val())})}),t.promise},this.addData=function(e,t){console.log(e,t),o.firebase.onAuth(function(i){console.log(i),i&&o.firebase.child("module/"+e+"/"+o.info.uid).push(t)})},this.getData=function(t){var i=e.defer();return o.firebase.onAuth(function(e){e&&o.firebase.child("module/"+t+"/"+o.info.uid).on("value",function(e){return i.resolve(e.val())})}),i.promise},this.getAllData=function(t){var i=e.defer();return o.firebase.onAuth(function(e){e&&o.firebase.child("module/"+t).on("value",function(e){return i.resolve(e.val())})}),i.promise},this.isAdmin=function(){var t=e.defer();return o.firebase.onAuth(function(e){e&&o.firebase.child("admins").on("value",function(i){var n=Object.keys(i.val()),o=e.uid.replace("simplelogin:","");t.resolve(_.contains(n,o))})}),t.promise},this.saveFontSize=function(e){o.firebase.onAuth(function(t){t&&o.firebase.child("font/"+o.info.uid).set(e)})},this.getFontSize=function(){var t=e.defer();return o.firebase.onAuth(function(e){e&&o.firebase.child("font/"+o.info.uid).on("value",function(e){return t.resolve(e.val())})}),t.promise},this}]).factory("Aspects",["User","$q","$location",function(e,t,i){this.texts={"Family Well-Being":"the overall well-being of you and your family","Family Happiness":"your and your familyâ€™s happiness",Health:"your health (physical and mental)",Morality:"your morality (that is, living up to your personal values)","Family Relationships":"your family relationships","Financial Security":"your financial security","Options & Possibilities":"your options and possibilities in life","Meaning & Value":"your sense that your life is meaningful and has value","Life Satisfaction":"how satisfied you are with your life","Enough Time & Money":"your feeling that you have enough time and money","Peace, Calm & Harmony":"how peaceful, calm, and harmonious your life is",Independence:"your feeling of independence and self-sufficiency","Making a Difference":"your sense that you are making a difference in the world",Worthwileness:"your feeling that the things you do are worthwhile","Safety & Security":"your physical safety and security",Respect:"your being treated with dignity and respect by others","Amount of Day Happy":"how much of the time you feel happy",Improvement:"your sense that things are getting better and better","Overall Happiness":"how happy you are overall with your life","Life Longevity":"your chance to live a long life"};var n=_.sample(Object.keys(this.texts),5);return this.names=function(){var o=t.defer();return e.getAspects().then(function(t){var r;r=-1!==i.path().split("/")[1].indexOf("overlap")?t.slice(0,3):t,console.log(t,r,n),t?o.resolve(r):(e.setAspects(n),o.resolve(r))}),o.promise},this.getColor=function(t,i){if(e.aspects){var n=70*(e.aspects.indexOf(t)+6),o=.99+i/100*-.24;return d3.hsl(n,.8,o).toString()}},this}]).factory("Style",["$window",function(){var e=function(){var e=document.createElement("style");return e.appendChild(document.createTextNode("")),document.head.appendChild(e),e.sheet}();return function(t,i,n){e.insertRule?e.insertRule(t+"{"+i+"}",n):e.addRule(t,i,n)}}]).factory("Slide",function(){return function(e,t){var i=d3.select(e).style("opacity","0"),n=i.style("width"),o=i.select(function(){return this.parentNode.insertBefore(this.cloneNode(!0),this)}).style("opacity","1"),r=i.select(function(){return this.parentNode});r.style("pointer-events","none"),o.transition().duration(t).style("left","-"+n).style("opacity","0").each("end",function(){o.remove(),r.style("pointer-events","auto")}),i.transition().duration(t).style("left","-"+n).style("opacity","1").each("end",function(){i.style("left","0px")})}}).factory("Font",["User",function(e){var t=this;return this.level=0,this.getSize=function(){return window.getComputedStyle(document.body).fontSize.replace("px","")/10},this.decreaseSize=function(){t.level>-3&&t.level--;var i=1.75*Math.pow(1.25,t.level)+"em";document.body.style.fontSize=i,e.saveFontSize(t.level)},this.increaseSize=function(){t.level<3&&t.level++;var i=1.75*Math.pow(1.25,t.level)+"em";document.body.style.fontSize=i,e.saveFontSize(t.level)},this.setSize=function(e){t.level=e,document.body.style.fontSize=1.75*Math.pow(1.25,t.level)+"em"},this}]);
"use strict";angular.module("well.survey",[]).controller("ResultsCtrl",["$scope","Aspects","Survey","Choices","User",function(e,t,n,s,i){if(e.weights=s.weights(),e.aspects.sorted=_.sortBy(e.aspects.names,function(t){return-1*e.weights[t]}),e.data=i.getData("threetwo"),!e.weights){e.weights={},_.each(e.aspects.names,function(t){e.weights[t]=Math.random()}),console.log(e.weights);var o=0;_.each(e.aspects.names,function(t){o+=e.weights[t]}),_.each(e.aspects.names,function(t){e.weights[t]=e.weights[t]/o})}}]).controller("SurveyCtrl",["$scope","Aspects","Survey","Style","$location","$routeParams","Trans",function(e,t,n,s,i){t.names().then(function(t){e.aspects.names=t,n.aspects=t}),e.survey={finished:!1},e.$watch("responses",function(){n.responded()&&(e.survey.finished=!0)},!0),e.next=function(){switch(i.path().split("/")[1]){case"threetwo":i.path("threetwo/instructions");break;case"overlap":i.path("overlap/instructions");break;case"fineoverlap":i.path("fineoverlap/instructions")}}}]).factory("Survey",["Aspects","$q",function(e,t){var n=this,s=this;return this.responses={},this.getResponses=function(){var i=t.defer();return n.aspects?i.resolve(s.responses):e.names().then(function(e){s.aspects=e,_.each(e,function(e){s.responses[e]||(s.responses[e]=null)}),i.resolve(s.responses)}),i.promise},this.respond=function(e,t){return n.responses[e]=t},this.responded=function(){return n.aspects&&_.every(s.aspects,function(e){return s.responses[e]})},this.randomize=function(){console.log("randomized");var i=t.defer();return n.getResponses().then(function(){e.names().then(function(e){for(var t in e)s.responses[e[t]]=Math.max(Math.ceil(99*Math.random()),Math.max(Math.ceil(99*Math.random()),Math.ceil(99*Math.random())));i.resolve(s.responses)})}),i.promise},this.safeRandomize=function(){return n.responded()?n.getResponses():n.randomize()},this.reset=function(){return n.aspects&&_.each(s.aspects,function(e){s.responses[e]=null}),n.responses},this.minMax=null,this.range=function(){var e=t.defer();return n.minMax?e.resolve(n.minMax):n.safeRandomize().then(function(t){var s=_.map(t,function(e){return e}),i=Math.max(0,_.min(s)-8),o=Math.min(100,_.max(s)+8);n.minMax=[i,o],console.log(n.minMax),e.resolve(n.minMax)}),e.promise},this}]).controller("TransCtrl",["$scope","Aspects","Survey","Trans","$rootScope","$timeout",function(e,t,n,s,i,o){t.names().then(function(t){e.aspects.names=t,n.aspects=t}),n.safeRandomize().then(function(){}),e.resize=!1,i.$on("trans:change",function(){o(function(){return e.resize=!e.resize})})}]).factory("Trans",["$timeout","$rootScope","Style",function(e,t,n){var s=this;return this.ition=function(){setTimeout(function(){d3.select(".option .panel").insert("h3","li"),d3.selectAll("range").style("opacity",1).transition().duration(1e3).style("opacity",0).remove().each("end",function(){d3.select(".option h3").text("Option 1")}),d3.selectAll(".axis text").filter(function(e){return e>0&&100>e}).style("opacity",1).transition().duration(1e3).style("opacity",0).each("end",function(){n(".axis .tick","display:none;"),n(".axis .tick:first-child, .axis .tick:last-child","display:block;")}),d3.selectAll("range svg").style("height",20).transition().duration(1e3).style("height",0);var e=d3.select(".option").style("width").replace("px","");d3.select(".option").style("width",e+"px").transition().delay(1e3).duration(1e3).style("width",e/2+"px").tween("event",function(){return function(){t.$broadcast("trans:change")}})},1)},s}]);
"use strict";angular.module("well.tradeoff",[]).controller("ThreeCtrl",["$scope","Choices","Tradeoff","Three","Two","Slide","$location","$routeParams","$timeout",function(e,o,i,t,n,s,r,c,a){e.choice={},e.choices=o,e.tradeoff=i,e.animate={one:!1,two:!1};var h=function(){e.animate.one=e.animate.two=!1,a(function(){return e.animate.one=!0},1),a(function(){return e.animate.two=!0},3e3)};e.hidePreamble=function(){i.preamble=!1,setTimeout(function(){t.loadChoice().then(function(o){e.choice=o,h()})},1)},i.preamble||t.loadChoice().then(function(o){e.choice=o,h()}),e.choose=function(o){e.choice=t.choose(o),s(".options",300),h()},e.$watch("choice",function(i){e.choices=o,e.completed=o.step++/(t.numberOfQs+n.numberOfQs),i||r.path("threetwo/dbec")})}]).controller("TwoCtrl",["$scope","Choices","Two","Three","Slide","User","$location","$timeout",function(e,o,i,t,n,s,r,c){e.choice=!0,e.choices=o,e.animate={one:!1,two:!1};var a=function(){e.animate.one=e.animate.two=!1,c(function(){return e.animate.one=!0},1),c(function(){return e.animate.two=!0},3e3)};i.loadChoice().then(function(o){e.choice=o,a()}),e.choose=function(o){e.choice=i.choose(o),n(".options",300),a()},e.$watch("choice",function(n){e.choices=o,e.completed=o.step++/(t.numberOfQs+i.numberOfQs),n||("password"===s.info.provider?(o.submit(),r.path("threetwo/exit")):r.path("threetwo/exit"))})}]).controller("TestCtrl",["$scope","Choices","Two","Three","Slide","User","$location",function(e,o,i,t,n,s,r){e.choice=!0,e.choices=o,e.options={one:0,two:0,choice:null,highlight:function(o){e.options.choice||(1===o?(e.options.one=e.choice.tradeoff[0],e.options.two=0):(e.options.two=e.choice.tradeoff[1],e.options.one=0))},select:function(o){e.options.choice=o,1===o?(e.options.one=e.choice.tradeoff[0],e.options.two=0):(e.options.two=e.choice.tradeoff[1],e.options.one=0)},reset:function(){e.options.choice||(e.options.one=e.options.two=0)}},i.loadChoice().then(function(o){e.choice=o}),e.choose=function(){var o=e.options.one?2*e.choice.i+1:2*e.choice.i+2;e.choice=i.choose(o),e.options.choice=null,e.options.reset(),n(".scenario",300)},e.$watch("choice",function(t){e.choices=o,e.completed=o.step++/i.numberOfQs,t||r.path("threetwo/exit")})}]).controller("CompleteCtrl",["$scope","User","Choices","$location",function(e,o,i,t){e.login={wrong:!1,placeholder:{email:"Enter your email",password:"Password"},submit:function(){e.login.email?e.login.password?o.login(this.email,this.password).then(function(o){e.login.wrong="in",console.log("Logged in as: ",o.uid),i.submit(),t.path("results")},function(o){e.login.wrong=o.code,"INVALID_EMAIL"===o.code?(e.login.email="",e.login.placeholder.email="Enter a valid email"):"INVALID_PASSWORD"===o.code&&(e.login.password="",e.login.placeholder.password="Enter a valid password"),console.error("Login failed: ",o)}):(e.login.wrong="INVALID_PASSWORD",e.login.placeholder.email="Enter a valid password"):(e.login.wrong="INVALID_EMAIL",e.login.placeholder.email="Enter a valid email")}}}]).factory("Tradeoff",function(){var e={};return e.sign=Math.random()>.5?"positive":"negative",console.log(e.sign),e.preamble=Math.random()>.5,e.positive_tradeoffs=[[4,4],[1,4],[4,1],[1,8],[2,4],[4,2],[8,1],[-4,-3],[-3,-2],[-2,-1],[-1,0],[0,1],[1,2],[2,3],[3,4]],e.negative_tradeoffs=[[-4,-4],[-4,-1],[-1,-4],[-8,-1],[-4,-2],[-2,-4],[-1,-8],[3,4],[2,3],[1,2],[0,1],[-1,0],[-2,-1],[-3,-2],[-4,-3]],e.checkCorners=function(e,o){return e>92&&8>o?"skip":8>e&&o>92?"skip":e>92||o>92?"negative":8>e||8>o?"positive":null},e.values=function(e,o){var i=null===this.checkCorners(e,o)?this.sign:this.checkCorners(e,o);return"positive"===i?this.positive_tradeoffs:"negative"===i?this.negative_tradeoffs:"skip"},e}).factory("Choices",["Aspects","Survey","Tradeoff","User",function(e,o,i,t){var n,s={MRS:{}};return e.names().then(function(e){n=e,_.each(n,function(e){s.MRS[e]={}})}),s.step=0,s.levels=o.responses,s.sign=i.sign,s.skipped=[],s.decisions=[],s.addMRS=function(e,o,i){this.MRS[o][e]=(i[0]+i[1])/2,this.MRS[e][o]=(i[0]+i[1])/-2},s.getMRS=function(e,o){if(o===e)return 0;if(this.MRS[o][e])return this.MRS[o][e];if(Object.keys(this.MRS[o]).length){var i=_.find(Object.keys(s.MRS[o]),function(o){return s.MRS[o][e]});return i?s.MRS[o][i]+s.MRS[i][e]:!1}return!1},s.record=function(e,o){this.decisions.push({aspects:e,i:o,t:Date.now()})},s.weights=function(){var e=0,o=_.map(n,function(o){var i=s.getMRS(o,n[0]);return e+=Math.pow(2,i),Math.pow(2,i)}),i={};return _.each(n,function(t,n){i[t]=o[n]/e}),i},s.submit=function(){t.addData("threetwo",{date:Date.now(),aspects:n,responses:s.levels,decisions:s.decisions,skipped:s.skipped,MRS:s.MRS,weights:s.weights()})},s}]).factory("Three",["Aspects","Survey","Tradeoff","Choices","$q",function(e,o,i,t,n){var s=this,r=this;this.pair=null,this.numberOfQs=9;var c,a;return this.choose=function(e){if(console.log(a),e?t.record(s.pair,e):(e=0,s.pair=s.pairs.shift()),e>6){if(e=0,!s.pairs.length)return!1;s.pair=s.pairs.shift()}var o=i.values(a[s.pair[0]],a[s.pair[1]]);return r.choice={aspects:s.pair,tradeoff:o[e],i:e}},this.loadChoice=function(){var s=n.defer();return e.names().then(function(e){c=e,r.aspects=[c[0],c[1],c[2]],o.safeRandomize().then(function(e){a=e,r.pairs=_.map(r.aspects,function(e,o){return[r.aspects[o],r.aspects[(o+1)%3]]}),r.pairs=_.filter(r.pairs,function(e){var o="skip"===i.values(a[e[0]],a[e[1]]);return o&&t.skipped.push(e),!o}),r.numberOfQs=3*r.pairs.length,console.log(e,a),s.resolve(r.choose(0))})}),s.promise},this}]).factory("Two",["Aspects","Survey","Tradeoff","Choices","Three","$q",function(e,o,i,t,n,s){var r,c,a=this;o.responded()||o.randomize();var h=this;return this.pair=null,this.numberOfQs=6,this.choose=function(e){if(e?t.record(a.pair,e):(e=0,a.pair=a.pairs.shift()),e>6){if(e=0,!a.pairs.length)return!1;a.pair=a.pairs.shift()}var o=i.values(c[a.pair[0]],c[a.pair[1]]);return{aspects:a.pair,tradeoff:o[e],i:e}},this.loadChoice=function(){var a=s.defer();return e.names().then(function(e){r=e,h.aspects=_.difference(r,n.aspects),o.safeRandomize().then(function(e){c=e,h.pairs=[[r[3],r[1]],[r[4],r[2]]],h.pairs=_.filter(h.pairs,function(e){var o="skip"===i.values(c[e[0]],c[e[1]]);return o&&t.skipped.push(e),!o}),h.numberOfQs=3*h.pairs.length,a.resolve(h.choose())})}),a.promise},this}]);
"use strict";angular.module("well.overlap",[]).factory("Overlap",["User","Aspects","Survey",function(e,t,o){var i=this,n=this;return this.doubled=Math.random()>.5,this.preamble=Math.random()>.5,this.decisions=[],this.skipped=[],this.record=function(e){i.decisions.push(e)},this.submit=function(){console.log("submit"),t.names().then(function(t){o.getResponses().then(function(o){console.log(t,o),e.addData("overlap",{date:Date.now(),aspects:t,responses:o,decisions:n.decisions,skipped:n.skipped})})})},n}]).factory("Abc",["Overlap","Choices","Tradeoff","Survey","Aspects","$q",function(e,t,o,i,n,s){var c,a={};return a.MRS={},a.positiveOK=function(e,t,o){return 93>e&&93>t&&93>o},a.negativeOK=function(e,t,o){return e>8&&t>8&&o>8},a.getSign=function(e,t,i){var n=o.sign;return"positive"===n?this.positiveOK(e,t,i)?"positive":this.negativeOK(e,t,i)?"negative":!1:"negative"===n?this.negativeOK(e,t,i)?"negative":this.positiveOK(e,t,i)?"positive":!1:void 0},a.choose=function(t){e.record({aspects:a.aspects,i:t,t:Date.now()});var i=this.getSign(c[a.aspects[0]],c[a.aspects[1]],c[a.aspects[2]]);return!i||t>6||"negative"===i&&3===t&&e.doubled||"positive"===i&&6===t&&e.doubled?!1:"positive"===i?{aspects:this.aspects,tradeoff:o.positive_tradeoffs[t],i:t}:"negative"===i?{aspects:this.aspects,tradeoff:o.negative_tradeoffs[t],i:t}:void 0},a.loadChoice=function(){var e=s.defer();return n.names().then(function(o){a.aspects=[o[0],o[1],o[2]],_.each(a.aspects,function(e){a.MRS[e]={},_.each(a.aspects,function(o){var i=t.getMRS(e,o);a.MRS[e][o]=i?i:0})}),i.safeRandomize().then(function(t){c=t,e.resolve(a.choose(0))})}),e.promise},a}]).factory("Abac",["Aspects","Survey","Overlap","Tradeoff","Choices","$q",function(e,t,o,i,n,s){var c=this,a=this;this.pair=null;var r,h;return t.responded()||t.randomize(),this.choose=function(e){if(o.record({aspects:a.aspects,i:e,t:Date.now()}),e?n.record(c.pair,e):(e=0,c.pair=c.pairs.shift()),e>6){if(e=0,!c.pairs.length)return!1;c.pair=c.pairs.shift()}var t=i.values(h[c.pair[0]],h[c.pair[1]]);return a.choice={aspects:c.pair,tradeoff:t[e],i:e}},this.loadChoice=function(){var n=s.defer();return e.names().then(function(e){r=e,a.aspects=[r[0],r[1],r[2]],t.getResponses().then(function(e){h=e,a.pairs=[[r[0],r[1]],[r[0],r[2]]],a.pairs=_.filter(a.pairs,function(e){var t="skip"===i.values(h[e[0]],h[e[1]]);return t&&o.skipped.push(e),!t}),a.numberOfQs=3*a.pairs.length,n.resolve(a.choose(0))})}),n.promise},this}]).factory("Fine",["Aspects","Survey","Overlap","Abc","$q","User",function(e,t,o,i,n,s){var c=this,a=this;this.tuple=[];var r,h;return this.done={},this.decisions=[],this.positive=null,this.choose=function(e){if(c.decisions.push({tradeoff:c.tradeoff?c.tradeoff:null,choice:e,t:Date.now()}),c.tradeoff&&(c.done[c.tradeoff.toString()]=!0),c.decisions.length>16)return c.submit(),!1;for(;!c.tradeoff||c.done[c.tradeoff.toString()];){var t=_.sample("positive"===c.positive?[[8,8,0],[8,0,8],[8,8,8]]:[[-8,-8,0],[-8,0,-8],[-8,-8,-8]]);console.log(t),c.tradeoff=_.map(t,function(e){return console.log(e),"positive"===c.positive?Math.ceil(Math.random()*e):Math.floor(Math.random()*e)})}return{tradeoff:c.tradeoff}},this.loadChoice=function(){var o=n.defer();return e.names().then(function(e){t.safeRandomize().then(function(t){r=e,h=t,c.positive=i.getSign(h[r[0]],h[r[1]],h[r[2]]),console.log(c.positive),o.resolve(a.choose(0))})}),o.promise},this.submit=function(){console.log("submit"),e.names().then(function(e){t.getResponses().then(function(t){s.addData("fineoverlap",{date:Date.now(),aspects:e,responses:t,decisions:c.decisions})})})},a}]).controller("AbacCtrl",["$scope","Choices","Abac","Slide","$location","$timeout",function(e,t,o,i,n,s){e.choice={},e.choices=t,e.animate={one:!1,two:!1};var c=function(){e.animate.one=e.animate.two=!1,s(function(){return e.animate.one=!0},1),s(function(){return e.animate.two=!0},3e3)};o.loadChoice().then(function(t){e.choice=t,c()}),e.choose=function(t){e.choice=o.choose(t),i(".options",300),c()},e.$watch("choice",function(o){e.choices=t,e.completed=t.step++/9,o||n.path("overlap/abc")})}]).controller("AbcCtrl",["$scope","Overlap","Abc","$location","Slide","Two","Abac","Choices","$timeout",function(e,t,o,i,n,s,c,a,r){e.overlap=t,e.abc=o,e.choice=!0,e.animate={one:!1,two:!1};var h=function(){e.animate.one=e.animate.two=!1,r(function(){return e.animate.one=!0},1),r(function(){return e.animate.two=!0},3e3)};t.preamble&&o.loadChoice().then(function(t){e.choice=t,h()}),e.hidePreamble=function(){t.preamble=!0,setTimeout(function(){o.loadChoice().then(function(t){e.choice=t,h()})},1)},e.choose=function(t){e.choice=o.choose(t),n(".options",300),h()},e.$watch("choice",function(o){e.choices=a,e.completed=a.step++/9,o||(t.submit(),i.path("overlap/exit"))})}]).controller("FineCtrl",["$scope","Overlap","Fine","$location","Slide","Two","Abac","Choices","$timeout",function(e,t,o,i,n,s,c,a,r){e.overlap=t,e.choice=!0,e.animate={one:!1,two:!1};var h=function(){e.animate.one=e.animate.two=!1,r(function(){return e.animate.one=!0},1),r(function(){return e.animate.two=!0},3e3)};t.preamble&&o.loadChoice().then(function(t){e.choice=t,h()}),e.hidePreamble=function(){t.preamble=!0,setTimeout(function(){o.loadChoice().then(function(t){e.choice=t,h()})},1)},e.choose=function(t){e.choice=o.choose(t),n(".options",300),h()},e.$watch("choice",function(t){e.choices=a,e.completed=a.step++/12,t||(o.submit(),i.path("fineoverlap/exit"))})}]);
"use strict";angular.module("well.results",[]).directive("sicilian",["$window","Aspects",function(t,e){return{restrict:"EA",scope:{responses:"=",weights:"="},link:function(n,r,i){var a=d3.select(r[0]).append("svg").attr("class","sicilian").style("width","100%");a.style("height",a.style("width")),window.onresize=function(){n.$apply()},n.$watch(function(){return angular.element(t)[0].innerWidth},function(){n.render()}),n.$watch("responses",function(){n.render()},!0),n.$watch("weights",function(){n.render()},!0);var o=null;i.$observe("sort",function(t){o=t});var s=e.names();n.render=function(){var t=_.map(s,function(t){return{name:t,weight:n.weights[t]}});t=_.sortBy(t,function(t){return"level"===o?n.responses[t.name]:-1*t.weight}),a.selectAll("*").remove();var r=a.style("width").replace("px",""),i=a.selectAll().data(t).enter().append("g").style("height",function(t){return t.weight*r});i.append("rect").attr("y",function(e){return _.reduce(t,function(n,i){return t.indexOf(i)>=t.indexOf(e)?n:n+i.weight*r},0)}).attr("width",function(){return r}).attr("height",function(t){return t.weight*r}).style("fill",function(t){return e.getColor(t.name,30)}),i.append("rect").attr("y",function(e){return _.reduce(t,function(n,i){return t.indexOf(i)>=t.indexOf(e)?n:n+i.weight*r},0)}).attr("width",function(t){return n.responses[t.name]/100*r}).attr("height",function(t){return t.weight*r}).style("fill",function(t){return e.getColor(t.name,140)}),i.append("text").attr("class","weight").attr("y",function(e){return e.weight*r*.5+_.reduce(t,function(n,i){return t.indexOf(i)>=t.indexOf(e)?n:n+i.weight*r},0)}).attr("dy",".5em").text(function(t){return d3.format("%")(t.weight)})}}}}]).directive("chart",["$window","User",function(t,e){return{restrict:"EA",scope:{},link:function(n,r){var i=d3.select(r[0]).append("svg");window.onresize=function(){n.$apply()},n.$watch(function(){return angular.element(t)[0].innerWidth},function(){a&&n.render()});var a;e.getData("threetwo").then(function(t){if(a=_.map(t,function(t){var e=_.reduce(t.aspects,function(e,n){return e+t.responses[n]*t.weights[n]},0);return{score:e,date:t.date}}),1===a.length){var e=_.clone(a[0]);e.date=a[0].date-5e4;var r=_.clone(a[0]);r.date=a[0].date+5e4,a=[e,a[0],r]}console.log(a),n.render()}),n.render=function(){console.log(a),i.selectAll("*").remove();var t=r[0].parentNode.getBoundingClientRect();console.log(t);var e=t.width/3,n=t.width;i.attr("width",n).attr("height",e);var o=d3.time.scale().domain([a[0].date,a[a.length-1].date]).rangeRound([30,n-30]),s=d3.scale.linear().domain([0,100]).rangeRound([e-30,30]),c=d3.svg.axis().scale(o).orient("bottom"),l=d3.svg.axis().scale(s).orient("left");i.append("g").attr("class","x axis").attr("transform","translate(0, "+Number(e-30)+")").call(c),i.append("g").attr("class","y axis").attr("transform","translate(30,0)").call(l);var u=d3.svg.line().x(function(t){return o(t.date)}).y(function(t){return s(t.score)}).interpolate("basis");i.append("path").attr("class","line").datum(a).attr("d",u)}}}}]).controller("ExitCtrl",["$scope","User","$location",function(t,e,n){t.satisfaction={level:null,comments:null,submitted:!1,submit:function(){t.satisfaction.submitted=!0,e.addData("feedback",{t:Date.now(),module:n.path().split("/")[1],level:t.satisfaction.level,comments:t.satisfaction.comments})}}}]);
"use strict";angular.module("well.instruct",[]).controller("InstructorCtrl",["$scope","Survey","$location","$timeout",function(t,e,n,i){e.safeRandomize(),t.instructions={step:0,next:function(){return t.instructions.step++},prev:function(){return t.instructions.step--},repeat:function(){return t.instructions.step=t.instructions.choice=0},animOne:null,animTwo:null,understood:function(){switch(n.path().split("/")[1]){case"threetwo":n.path("threetwo/abbcca");break;case"overlap":n.path("overlap/abac");break;case"fineoverlap":n.path("fineoverlap/tradeoff")}}},t.$watch("instructions.step",function(e){t.instructions.animOne=t.instructions.animTwo=null,2===e&&i(function(){t.instructions.animOne="one"},2e3),3===e&&i(function(){t.instructions.animTwo="one"},2e3)})}]).controller("InstructCtrl",["$scope","Survey","$interval","$timeout","Point","$location",function(t,e,n,i,o,s){e.safeRandomize(),t.instructions={next:function(){switch(s.path().split("/")[1]){case"threetwo":s.path("threetwo/abbcca");break;case"overlap":s.path("overlap/abac");break;case"fineoverlap":s.path("fineoverlap/tradeoff")}}},t.delay=6e3,t.instructions.partZero=!0;var r=function(){switch(t.t/t.delay){case 1:t.instructions.partOne=!0,t.instructions.partZero=!1;break;case 2:t.instructions.partTwo=!0,t.instructions.diffOne=4,t.instructions.animOne="one";break;case 3:t.instructions.partOne=!1,t.instructions.partThree=!0;break;case 4:t.instructions.partFour=!0,t.instructions.diffTwo=4,t.instructions.animTwo="one";break;case 5:t.instructions.partThree=!1,t.instructions.partFive=!0,t.instructions.highlightOne=!0,t.instructions.highlightTwo=!0,o.leftRight();break;case 6:t.animating=!1,n.cancel(t.instructions.promise),t.instructions.highlightOne=!1,t.instructions.highlightTwo=!1,t.instructions.done=!0}};t.instructions.run=function(){o.hide(),t.instructions.done=!1,t.instructions.partZero=!0,t.instructions.partOne=!1,t.instructions.partTwo=!1,t.instructions.partThree=!1,t.instructions.partFour=!1,t.instructions.partFive=!1,t.instructions.highlightOne=!1,t.instructions.highlightTwo=!1,t.instructions.diffOne=0,t.instructions.diffTwo=0,t.t=0,t.completed=0,t.animating=!0,t.instructions.promise=n(function(){t.animating&&(t.t+=10,t.completed=t.t/(6*t.delay),r())},10)},t.instructions.run()}]).directive("stepper",function(){return{restrict:"E",scope:{steps:"=",parent:"="},templateUrl:"stepper.html",link:function(t){console.log(t.steps)}}}).factory("Point",["$timeout",function(){var t=this,e=this,n=d3.select(".pointer-hand");return this.mouse={x:400,y:400},document.onmousemove=function(e){t.mouse.x=e.clientY,t.mouse.y=e.clientX},this.isWithin=function(t){var e=document.querySelector(t).getBoundingClientRect(),n=document.querySelector(".pointer").getBoundingClientRect();return n.left>e.left&&n.left<e.left+e.width&&n.top>e.top&&n.top<e.top+e.height},this.hide=function(){n.style("display","none")},this.leftRight=function(){var i=document.querySelector(".left").getBoundingClientRect(),o=document.querySelector(".right").getBoundingClientRect();n.style("display","block").style("left",t.mouse.y+"px").style("top",t.mouse.x+"px").transition().duration(2e3).style("left",i.left+i.width/2+"px").style("top",i.top+i.height/2+"px").tween("position",function(){return function(){d3.select(".left").classed("hover",e.isWithin(".left")),d3.select(".right").classed("hover",e.isWithin(".right"))}}).transition().duration(1e3).style("left",o.left+o.width/2+"px").style("top",o.top+o.height/2+"px").tween("position",function(){return function(){d3.select(".left").classed("hover",e.isWithin(".left")),d3.select(".right").classed("hover",e.isWithin(".right"))}}).each("end",function(){d3.select("body").append("svg").attr("width","100%").attr("height","100%").style({position:"fixed",top:0,left:0,"z-index":999,"pointer-events":"none"}).append("circle").attr("cx",o.left+o.width/2).attr("cy",o.top+o.height/2).attr("r",0).style("fill","none").style("stroke","#000").style("stroke-opacity",1).style("stroke-width","2px").transition().duration(1e3).attr("r",100).style("stroke-opacity",0),d3.select(".left").style("opacity",1).transition().duration(1e3).style("opacity",.3)})},this}]);
"use strict";angular.module("well.admin",[]).controller("AdminCtrl",["$scope","User",function(t,e){e.isAdmin().then(function(e){t.isAdmin=e}),t.data={type:"JSON"},e.getAllData("threetwo").then(function(e){t.data.threetwo=e}),e.getAllData("overlap").then(function(e){t.data.overlap=e}),e.getAllData("fineoverlap").then(function(e){t.data.fineoverlap=e})}]);
"use strict";angular.module("well.modular",[]).controller("ConfigCtrl",["$scope","$timeout",function(e,s){e.range=d3.range,e.survey={info:{title:"",author:""},aspects:[[]],addAspects:function(s,o){e.survey.aspects[s]=_.union(e.survey.aspects[s],o),e.nextAspects=null},addBucket:function(){e.survey.aspects.push([])},removeBucket:function(s){e.survey.aspects.splice(s,1),e.survey.samples.splice(s,1)},samples:[],tasks:[],newCombo:{type:"pairwise",aspects:[]},addCombo:function(){e.survey.newCombo.aspects.length>1&&e.survey.tasks.push(_.merge({},e.survey.newCombo))},preamble:{type:"preamble",text:"On each of the following screens, we will ask you to choose between two different ways in which your life might change. On each screen you will have two options to choose from. In each option, levels of some of the aspects of your life that you have just rated will either increase or decrease."},addPreamble:function(){e.survey.tasks.push(_.merge({},e.survey.preamble))},language:{option:{one:"Option 1",two:"Option 2"},prefer:{one:"I Prefer Option 1",two:"I Prefer Option 2"}}},e.$watch("user.info",function(){s(function(){e.survey.info.author=e.user.info.password.email})}),e.$watch("survey.samples",function(){s(function(){e.allSamples=e.survey.aspects.reduce(function(s,o,t){return s.concat(d3.range(1,e.survey.samples[t]+1).map(function(e){return String.fromCharCode(t+97)+e}))},[])})},!0),e.configuration={info:e.survey.info,aspects:e.survey.aspects,samples:e.survey.samples,tasks:e.survey.tasks,language:e.survey.language}}]).factory("Choice",["User","Aspects","Survey",function(){var e={};return e}]);
//# sourceMappingURL=maps/all.min.js.map