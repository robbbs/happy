{"version":3,"sources":["app.js","controllers.js","directives.js","filters.js","services.js","survey.js","tradeoff.js","overlap.js","results.js","instructions.js","admin.js"],"names":[],"mappings":"AAAA;AACA,ACDA,gPDCgP,wCAAA;ACAhP,ACDA,EFEE,iDCDiD,OAAO,GAAG,uFAAA;ACA7D,ACDA,EFEE,EDCE,6CEF6C,KAAK,GAAG,uBAAA;ACAzD,ACDA,EHGE,ACDA,EFEE,aAAa,UAAU,gBGHgB,MAAM;ACAjD,ACDA,ELKE,ACDA,AEFA,EDCE,yCEFyC,IAAI,GAAG,8CAAA;ACApD,ACDA,EFEE,EJIE,ACDA,ACDA,ACDA,0CEF0C,WAAW,GAAG,mDAAA;AED5D,ADCA,EHGE,ACDA,ACDA,ELKE,AEFA,EDCE,WDCW,UAAU,qBMNqB,SAAS,GAAG,oGAAA;AHI5D,AIJA,ACDA,ERQE,AIJA,ACDA,ACDA,ELKE,ECDE,KCDK,MAAM,2BIJ2B,OAAO,GAAG,8BAAA;AEDtD,ADCA,ELKE,AIJA,AHGA,AEFA,ENME,ACDA,AIJA,IHGI,sCMNsC,QAAQ,GAAG,uBAAA;AEDzD,ADCA,EFEE,ACDA,AJIA,ACDA,ACDA,ENME,AGHA,EFEE,ACDA,WFEW,SAAS,sBSTsB,cAAc,GAAG,8CAAA;ACAjE,EVUE,AGHA,AMNA,AFEA,AFEA,ACDA,ELKE,AOPA,AJIA,EFEE,uCQRuC,SAAS,GAAG,mBAAA;APQzD,EOPE,ATSA,AQRA,AFEA,AHGA,ACDA,ELKE,AQRA,AFEA,IJII,GCDG,OAAO;EFGhB,AEFA,AIJA,AHGA,EMNE,AVUA,ASTA,AJIA,ACDA,EJIE,AMNA,WRQW,YAAY;EUT3B,AVUA,ACDA,AMNA,ADCA,EHGE,AMNA,ALKA,ACDA,EGHE,ENME;EQPN,ATSA,AEFA,AIJA,AHGA,AEFA,ENME,AQRA,ENME,AOPA,AJIA;AFGN,EOPE,ATSA,AGHA,EJIE,ASTA,AFEA,ACDA,AHGA,ACDA,EJIE,KCDK,MHGM,IGHI,UHGU;EAC7B,AGHA,AIJA,EGHE,ATSA,AQRA,ALKA,ACDA,ACDA,EJIE,AMNA;EEDJ,ATSA,AMNA,EPOE,AGHA,ACDA,ACDA,EIJE,ADCA,AFEA,EJIE;EQPN,ATSA,AEFA,EHGE,ASTA,AFEA,AHGA,ACDA,ACDA,EEFE,ENME,SFES,SAAS;AGF1B,EHGE,EUVE,ATSA,AQRA,AFEA,ADCA,EFEE,ACDA,EGHE,GLKG,CDCC,OCDO;EONjB,APOA,EHGE,ACDA,AIJA,EIJE,AFEA,ACDA,AJIA,AEFA,EJIE;EQPN,ATSA,EDCE,AGHA,AMNA,ALKA,ACDA,ACDA,EEFE,ENME,AKLA,SPOS,OAAO;EACtB,ACDA,AKLA,EIJE,APOA,AMNA,ELKE,ACDA,EHGE,AKLA,ACDA;EEDN,ATSA,AEFA,AGHA,ENME,ASTA,AJIA,EGHE,ENME,AEFA,EGHE;AGFV,APOA,COPC,CAAA,ATSC,AIJA,ELKE,ASTA,AHGA,IJII,AMNA,AJIA,EGHE,CJIC,MHGM,CGHC,QHGQ;AKJ1B,CAAC,CLKC,AGHA,AEFD,EJIG,AKLA,EGHE,ADCA,AJIA,EFEE,EKLE,MFEK,UAAU,GAAG,+EAAA;EAC1B,ELKE,ACDA,AEFA,EKLE,AFEA,EJIE,AOPA,ALKA,EGHE;EJKR,EHGE,AKLA,EJIE,ECDE,AMNA,AJIA,AEFA,EGHE,AFEA,OPOO,QAAQ;AGFzB,EHGE,EKLE,EJIE,AOPA,AJIA,EGHE,ADCA,EJIE,AOPA;EJKR,ELKE,ACDA,AGHA,EGHE,ACDA,AFEA,EJIE,AOPA;EJKN,ELKE,ACDA,AMNA,AHGA,AEFA,IJII,AMNA,ECDE,OTSO,OAAO;EACtB,AOPA,AHGA,ACDA,ACDA,ILKI,AOPA,INMI,AOPA;EFGR,AHGA,AEFA,ENME,AKLA,EGHE,EPOE,AQRA,MPOM;AKJd,CAAC,CAAA,EPOG,AIJA,AEFA,EEFE,AHGA,EJIE,ECDE,AOPA,GFEE,GAAG,CPOE,EOPC,MPOO,wDOPP;EPQhB,AOPA,EHGE,ACDA,EJIE,AKLA,EEFE,ECDE,EPOE;EKJV,AFEA,ELKE,AIJA,EKLE,ADCA,AFEA,ELKE,ICDI;EKJV,AFEA,ELKE,ASTA,AHGA,EEFE,AJIA,EHGE,ECDE,OFEO,QAAQ;EACvB,ASTA,AFEA,ADCA,EDCE,EJIE,AOPA,AJIA,IFEI;EONR,AHGA,ENME,AOPA,AHGA,ECDE,EJIE,AOPA,INMI;EKJV,EPOE,ASTA,AHGA,EFEE,ECDE,EJIE,AOPA,ENME,KFEK,SAAS;EACxB,AOPA,EEFE,AHGA,IFEI,ACDA,EJIE,ACDA,EMNE;IRSR,AOPA,ADCA,EGHE,AJIA,IJII,ACDA,AEFA,EIJE;EDEV,ADCA,ENME,ICDI,AQRA,ALKA,ACDA,EHGE,AMNA,ORQO,SAAS;EACxB,AOPA,ADCA,IGHI,EDCE,AJIA,ACDA,EJIE,ACDA;IFGN,ASTA,AFEA,ADCA,EDCE,EGHE,AJIA,EHGE,ECDE;IFGR,AOPA,ADCA,EGHE,ALKA,ECDE,EHGE,AMNA,EPOE,KDCK,QAAQ;EACvB,EMNE,ECDE,EEFE,ALKA,ACDA,EHGE,EDCE,AOPA;IRSR,AKLA,EIJE,AHGA,ECDE,AHGA,EHGE,ACDA,AMNA;ECAR,AJIA,ELKE,AMNA,ECDE,AHGA,MHGM,ACDA,AMNA,KRQK,SAAS;ASR1B,AJIA,CIJC,AJIA,CLKC,ASTD,AJIA,ACDC,EFEE,IGHI,ECDE,EPOE,ACDA,CGHA,GIJG,GJIG,GAAG,MIJM,GAAG,SJIT,2DIJS;AHI9B,CAAC,CGHC,AJIA,ACDD,ENMG,AIJA,EGHE,ECDE,EPOE,ECDE,IIJG,OAAO,GAAG,gFAAA;EGFvB,ALKA,ACDA,ACDA,ENME,IOPI,ACDA,EPOE,ICDI,OFEO,SAAA;EIHnB,ACDA,ACDA,IGHI,AFEA,EPOE,ACDA,AOPA,MNMM;EGFZ,ACDA,ECDE,AHGA,EJIE,ACDA,CDCC,CAAA,ASTC,ADCA,MNMM;EFGZ,ECDE,AGHA,ACDA,ACDA,ECDE,IEFI,ADCA,INMI;AFGd,CAAC,CAAA,ECDG,AIJA,ACDA,EFEE,EJIC,AOPC,ACDA,ECDE,EPOE,2BFEL;EACL,AMNA,ILKI,AMNA,AFEA,EIJE,ADCA,AJIA,EFEE;EIHR,ENME,AKLA,IJII,ACDA,AKLA,AHGA,EKLE,ADCA;ARSV,CAAC,CAAA,EMNG,EJIE,AKLA,AHGA,ACDA,EJIE,EQRE,EDCE;INOR,AIJA,ELKE,EQRE,AFEA,AHGA,ACDA,MGHM;ENOZ,IKLI,ADCA,ELKE,AIJA,EIJE,ALKA,EIJE;ANOZ,CAAC,CAAA,EKLG,ADCA,ILKI,EQRE,ALKA,ACDA,IGHI,CNMA,KAAK,GAAG,mCAAA;EACpB,AKLA,EDCE,EGHE,ELKE,EHGE,EOPE,AHGA;EEDV,ELKE,AOPA,EHGE,EFEE,ACDA,EJIE,AOPA;ECAR,EPOE,AKLA,ADCA,ILKI,AOPA,AJIA,ACDA;EIHN,AHGA,EJIE,EKLE,AHGA,ACDA,IJII,AOPA;ECAR,AHGA,EFEE,ACDA,EHGE,AKLA,ENME,AOPA;ICAJ,ALKA,ACDA,ACDA,ELKE,ACDA,AKLA,ICDI;EJKR,ACDA,EJIE,AMNA,ADCA,EGHE,EPOE,AMNA;EPQN,AGHA,ACDA,ACDA,ECDE,ELKE,EOPE,EDCE;EPQR,AKLA,ECDE,AHGA,ACDA,EHGE,EOPE,ADCA;EHIN,EJIE,AGHA,AEFA,ECDE,ELKE,AOPA,ADCA;EHIN,EJIE,AMNA,AHGA,AEFA,EJIE,AOPA,IDCI;IHIN,ACDA,ELKE,AMNA,AHGA,EFEE,AOPA,IDCI;EFGV,ILKI,ACDA,AGHA,EIJE,AFEA,AHGA,MIJM;EFGZ,EDCE,EJIE,ACDA,AEFA,EKLE,AFEA,ICDI;EHIV,EJIE,AKLA,EJIE,EOPE,AFEA,AHGA,MIJM;EHIZ,EJIE,AKLA,EGHE,AFEA,AHGA,EFEE,IMNI;IDER,AHGA,ACDA,ACDA,ELKE,EQRE,EPOE,AMNA;IJKN,ACDA,EEFE,ADCA,ELKE,ACDA,AOPA,ADCA;EJKN,ECDE,EHGE,EDCE,AQRA,AFEA,ADCA,EEFE;EJKR,IHGI,ACDA,AOPA,AJIA,EEFE,ACDA,AFEA;IFGJ,EEFE,ELKE,ACDA,AOPA,AFEA,AFEA,EGHE;MDEJ,AHGA,EHGE,ACDA,AOPA,ADCA,AFEA,EDCE;IEDN,ENME,AGHA,AEFA,EJIE,AOPA,AJIA,EGHE;EDER,EHGE,AEFA,ILKI,ACDA,AOPA,ADCA,AHGA;EEDN,AHGA,AEFA,IGHI,AJIA,EJIE,ACDA,AMNA;AFGR,CAAC,CFEC,AEFD,ECDG,AFEA,EJIE,ECDE,AOPA,EDCE,MFEK,QAAQ,GAAG,oEAAA;EACxB,ECDE,AHGA,ACDA,IJII,ACDA,AOPA,IDCI;EHIV,ACDA,EFEE,EGHE,ELKE,AOPA,ERQE,IOPI;EHIZ,ACDA,EFEE,EGHE,ELKE,AOPA,IRQI,AOPA;EJKV,ECDE,ACDA,IGHI,AFEA,ENME,ACDA,IMNI;EJKZ,EEFE,EDCE,EJIE,ACDA,AOPA,AFEA,ICDI;IJKR,ACDA,ACDA,EGHE,EPOE,EDCE,AMNA,ACDA;IFGN,EFEE,ACDA,EHGE,AOPA,ADCA,EPOE,AMNA;IFGN,ECDE,EJIE,AOPA,AFEA,AHGA,EHGE,AOPA;EHIR,IEFI,ELKE,AOPA,ADCA,AFEA,EFEE,EHGE;EIHV,IEFI,ACDA,ECDE,ALKA,EFEE,AIJA,ELKE;IONR,AJIA,ACDA,IIJI,AFEA,ENME,AKLA,IJII;EMLZ,AJIA,EKLE,EJIE,EEFE,ADCA,EJIE,EDCE;AONZ,CAAC,CCDC,ADCD,AJIC,IGHI,EFEE,ECDE,ELKE,ECDE,CMNA,KAAK,GAAG,oBAAA;ECApB,ADCA,EDCE,AHGA,ECDE,IJII,AKLA,IJII;IONV,AFEA,ACDA,AJIA,ACDA,ICDI,ILKI,ICDI;EKJd,AFEA,EIJE,ADCA,EJIE,AEFA,MLKM,ICDI;EKJd,AFEA,EIJE,ADCA,AJIA,AEFA,MLKM,ICDI;AKJd,CAAC,CAAA,AFEC,EIJE,AHGA,EEFE,AJIA,IHGI,GMNE,GLKI,CKLA,GAAG,8DAAA;EACjB,EEFE,AJIA,EGHE,AFEA,ELKE,AGHA,QFEQ;EKJd,EEFE,AJIA,EJIE,AKLA,EEFE,EJIE,IFEI;EKJZ,ENME,AQRA,EDCE,AHGA,ECDE,IFEI,IFEI;EKJd,ENME,AQRA,AJIA,EGHE,EFEE,IFEI,IFEI;EKJd,EEFE,ERQE,AIJA,ACDA,EEFE,EJIE,IFEI;EKJZ,EEFE,EDCE,AJIA,EHGE,AIJA,ACDA,QJIQ;IONZ,AFEA,AHGA,IHGI,AOPA,AFEA,EDCE,MHGM;EKJd,EEFE,ALKA,EEFE,ELKE,AIJA,EGHE,INMI;EEDZ,EKLE,AFEA,ADCA,ELKE,AOPA,EHGE,QHGQ;EEDd,EKLE,AHGA,ECDE,ACDA,EPOE,AIJA,QHGQ;IONZ,ALKA,EHGE,AMNA,ACDA,AFEA,EDCE,MHGM;IDEV,AQRA,ALKA,EGHE,ECDE,AHGA,ACDA,IJII;EDEV,EMNE,ADCA,EGHE,ALKA,EFEE,AGHA,EGHE;EPQR,AKLA,ECDE,EHGE,ACDA,EHGE,AOPA,IDCI;EFGV,EDCE,EJIE,AMNA,EEFE,ALKA,EFEE,AMNA;IJKN,ACDA,ACDA,ECDE,ENME,ACDA,AOPA,EDCE;EJKR,ACDA,ACDA,ECDE,EEFE,ERQE,ECDE,EMNE;EJKV,ACDA,ACDA,EGHE,ERQE,AMNA,ELKE,IMNI;AHIZ,CAAC,CIJC,AJID,EEFG,AHGA,AEFA,ILKI,ACDA,EMNE,MHGK,SAAS,GAAG,mEAAA;EIHzB,AJIA,EEFE,AHGA,AEFA,ILKI,ACDA,AMNA;ACAR,CAAC,CAAA,EJIG,ACDA,ECDE,AHGA,EIJE,EPOE,ACDA,KOPI,OAAO;EACnB,EJIE,ACDA,ECDE,EHGE,EHGE,ACDA,AMNA;EHIR,EIJE,AHGA,ICDI,ENME,ACDA,AMNA,AJIA;ECAR,ACDA,EGHE,EFEE,ENME,AGHA,EFEE,AMNA;EHIR,ACDA,EFEE,EKLE,EFEE,ENME,ACDA,AMNA;EHIR,EDCE,AEFA,EGHE,AFEA,ENME,EOPE,ENME;EEDV,EKLE,AFEA,AFEA,ACDA,ELKE,EOPE,ENME;EEDR,EHGE,AQRA,AFEA,ADCA,EDCE,EGHE,ENME;EDER,EQRE,AFEA,AHGA,ACDA,ECDE,EEFE,ENME;EGFR,EJIE,AGHA,AEFA,EGHE,AFEA,ACDA,MNMM;AGFZ,CAAC,CAAA,ACDC,ELKE,AQRA,EFEE,ACDA,AJIA,IFEI,GGHE,KAAK,GAAG,oCAAA;ACApB,CAAC,CGHC,AJIA,ACDD,ELKG,EMNE,ELKE,AMNA,AJIA,QEFO,YAAY,GAAG,2CAAA;AGF9B,ERQE,AIJA,ACDA,ECDE,ELKE,EMNE,EJIE,EKLE,KAAK,GAAG,aAAA;ARSpB,CAAC,CAAA,AQRC,AFEA,ELKE,AGHA,ACDA,IEFI,AJIA,QHGO,SAAS,GAAG,WAAA;EACzB,ACDA,AOPA,AFEA,EHGE,AEFA,EDCE,EGHE;ANOR,CAAC,CDCC,ACDD,AOPC,EFEE,AHGA,ECDE,ACDA,EEFE,ONMM,GAAG,GAAG,kCAAA;EAClB,AOPA,ALKA,EHGE,AMNA,EDCE,EEFE,AHGA;EJKN,AGHA,EFEE,AOPA,AHGA,ECDE,AFEA,EGHE;EPQN,ECDE,AOPA,ALKA,AEFA,ECDE,AFEA,EGHE;EPQN,AQRA,ELKE,EFEE,AKLA,ADCA,EEFE,AHGA;EIHN,ERQE,ECDE,AEFA,ACDA,EEFE,ACDA,AFEA;ELMN,EQRE,EPOE,EKLE,ACDA,AJIA,ACDA,ACDA;ELMN,ECDE,AOPA,EHGE,ECDE,ACDA,AHGA,EDCE;EHIR,AQRA,EPOE,EGHE,EGHE,AFEA,ECDE,AHGA;AHIV,CAAC,CAAA,AQRC,IPOI,AGHA,EGHE,AFEA,ECDE,AHGA;IKJN,EPOE,AGHA,ACDA,EFEE,EIJE,EDCE;IEDR,ALKA,EFEE,AGHA,EGHE,AFEA,ECDE;IEDN,ALKA,IFEI,AKLA,AFEA,EGHE,AFEA;EGFR,ALKA,IFEI,EKLE,ACDA,EHGE,ACDA;EGFR,ALKA,IFEI,EKLE,ACDA,AHGA,ECDE;IGFN,ALKA,EGHE,ACDA,AHGA,EHGE,EIJE;EGFR,EFEE,ACDA,AHGA,EHGE,AEFA,EEFE;EGFN,ADCA,AHGA,EEFE,ELKE,EEFE,EEFE;AEDV,CAAC,CDCC,ACDD,AHGC,EIJE,ALKA,IFEI,EIJE,MEFK,QAAQ,GAAG,gCAAA;AHI1B,CAAC,CEFC,ACDA,AJIA,ACDD,EIJG,EPOE,MIJM;ACAZ,CAAC,CAAA,AHGC,EKLE,ADCA,ENME,MIJM,CCDA,IAAI,GAAG,sDAAA;EACjB,ECDE,AJIA,EKLE,EPOE,EIJE;ECAR,ECDE,AJIA,IFEI,AOPA,IHGI;ECAV,ECDE,ENME,AEFA,EKLE,IHGI;ECAV,ILKI,AOPA,ADCA,EJIE,EEFE;ECAR,EEFE,EDCE,ENME,EEFE,AEFA;ECAR,ILKI,AOPA,EDCE,AJIA,AEFA;ECAN,EHGE,EEFE,EJIE,AOPA,ADCA;EDEN,EHGE,AEFA,EJIE,EOPE,ADCA;EDEN,AHGA,AEFA,IJII,AOPA,EDCE;AFGR,CAAC,CFEC,AEFD,EGHG,AFEA,ECDE,ENME,KIJI,QAAQ;AFGpB,CAAC,CAAA,AEFC,EEFE,ECDE,AFEA,ELKE,KEFI,OAAO,GAAG,4BAAA;EIHpB,AJIA,AEFA,ICDI,ELKE,AOPA;ADER,CAAC,CAAA,AFEC,EFEE,EGHE,ELKE,AOPA;EHIN,ECDE,AHGA,IFEI,AOPA;EHIN,ECDE,AHGA,IFEI,AOPA;EHIN,EFEE,EGHE,ELKE,AOPA;EHIN,ECDE,AHGA,EKLE,EPOE;IEDJ,AEFA,EGHE,AFEA,ELKE;IONJ,ALKA,EGHE,ADCA,EJIE;EONN,EFEE,AHGA,AEFA,IJII;EONN,ELKE,EGHE,ADCA,EJIE;AONR,CAAC,CAAA,ELKG,AEFA,IJII,AKLA;IHIJ,EEFE,EJIE,AKLA;IHIJ,AEFA,ICDI,ELKE;IEDN,EEFE,EJIE,EKLE;IHIN,AEFA,EJIE,IKLI;ILMN,AEFA,EEFE,ECDE;ELMN,EEFE,AEFA,ECDE;ALMN,CAAC,CAAA,AIJC,EFEE,EGHE,SLKQ,IAAI,GAAG,wDAAA;EACnB,AIJA,ECDE,AHGA;EGFF,ELKE,AEFA,AEFA;ECAF,ELKE,AEFA,AEFA;EFGF,EGHE,ELKE,AIJA;EFGJ,EGHE,ADCA,EJIE;EEDJ,IFEI,AKLA,ADCA;IFGF,AEFA,EJIE,EKLE;IHIJ,EFEE,AIJA,ECDE;IDEJ,EJIE,AEFA,EGHE;EDEN,IJII,AEFA,EGHE;EDEN,EJIE,IKLI,AHGA;AEDR,IJII,EKLE,AHGA,MEFM,OAAO,GAAG,0CAAA;EACpB,ECDE,ELKE,EEFE;EEDN,ECDE,ELKE,AEFA;EGFJ,ADCA,IJII,AEFA;EGFJ,EDCE,EJIE,AEFA;IGFF,ADCA,EJIE,EEFE;IGFJ,EHGE,AEFA,EJIE;IIHJ,EJIE,AKLA,EHGE;EEDN,IJII,EKLE,AHGA;EEDN,IFEI,EFEE,EKLE;EDER,EFEE,EFEE,IKLI;EDER,EFEE,EFEE,IKLI;EHIR,AEFA,MJIM,EKLE;EHIR,AEFA,IJII,EKLE;EDEN,EFEE,EFEE,AKLA;IACF,ADCA,EFEE,EFEE;EKJN,EDCE,EJIE,IEFI;EGFR,ADCA,IJII,AEFA;AGFN,CAAC,CAAA,ADCC,EFEE,EFEE,UKLS,QAAQ,GAAG,oDAAA;EACxB,AHGA,EEFE,EJIE;EKJJ,AHGA,IEFI,EJIE;AEDR,CAAC,CGHC,AHGD,EEFG,IJII,KEFI,KAAK,GAAG,YAAA;EAClB,EGHE,EDCE,IJII;EKJR,EHGE,AEFA,IJII;EKJN,EHGE,EFEE,AIJA;ICAF,AHGA,EFEE,EIJE;ICAJ,AHGA,EFEE,AIJA;ECAJ,AHGA,IFEI,AIJA;ECAJ,AHGA,IFEI,EIJE;ICAJ,AHGA,EFEE,AIJA;ICAF,ELKE,AEFA,EEFE;ICAJ,AHGA,EFEE,AIJA;IACF,ECDE,AHGA,EFEE;IKJJ,AHGA,EEFE,EJIE;EKJN,AHGA,EEFE,IJII;AKJR,AHGA,CGHC,AHGA,CGHA,AHGA,AEFC,MJIM,KEFI,GGHG,EHGE,KGHK,GAAG,yFAAA;EACvB,AHGA,AEFA,QJIQ;EKJR,EHGE,AEFA,IJII;EKJN,EHGE,EEFE,EJIE;EKJN,EHGE,EEFE,EJIE;IKJJ,EHGE,AEFA,EJIE;IKJJ,AHGA,AEFA,IJII;EKJN,EHGE,AEFA,MJIM;EKJR,IHGI,AEFA,IJII;IKJN,AHGA,AEFA,MJIM;EIHR,ECDE,AHGA,IFEI;EIHN,EFEE,EGHE,ELKE;IKJJ,ADCA,EFEE,EFEE;IKJJ,ADCA,EFEE,IFEI;IEDN,EGHE,ADCA,IJII;IKJN,AHGA,EEFE,EJIE;EKJN,IHGI,AEFA,EJIE;EKJN,EHGE,AEFA,MJIM;EEDR,EGHE,ADCA,MJIM;AEDV,IEFI,ECDE,ELKE,IEFI,IAAI,GAAG,SAAA;EACjB,IGHI,ADCA,EJIE;EEDN,EGHE,ADCA,IJII;EKJN,AHGA,EEFE,IJII;EKJN,ADCA,EFEE,IFEI;EEDN,AEFA,ECDE,MLKM;EEDR,EGHE,ADCA,IJII;IEDJ,EGHE,ADCA,EJIE;MEDF,AEFA,ECDE,ELKE;IEDN,EEFE,ECDE,ILKI;IEDR,EGHE,ADCA,MJIM;IKJR,AHGA,EEFE,QJIQ;EKJZ,AHGA,IEFI,MJIM;EKJV,AHGA,IEFI,MJIM;IKJR,AHGA,AEFA,QJIQ;EIHV,ECDE,EHGE,MFEM;EIHV,ECDE,AHGA,QFEQ;AIHZ,CAAC,CCDC,ADCD,EFEG,QFEQ,CIJA,KAAK,GAAG,mDAAA;ECAlB,ADCA,EFEE,QFEQ;EEDV,AEFA,ECDE,QLKQ;EEDV,AEFA,ECDE,ULKU;EIHZ,ECDE,AHGA,QFEQ;EIHV,EFEE,EGHE,MLKM;EEDV,AEFA,ICDI,MLKM;EEDV,AEFA,ECDE,ULKU;AEDd,CAAC,CGHC,AHGD,EEFG,UJIU;AKJd,CAAC,CAAA,EDCG,YJIY,AKLD,QAAQ,GAAG,0FAAA;EACxB,IDCI,YJIY;EKJhB,IDCI,UJIU;EKJd,EDCE,UJIU;IKJV,EDCE,MJIM;IKJR,ADCA,MJIM;EKJR,EDCE,MJIM;EKJR,IDCI,MJIM;IKJR,EDCE,MJIM;IKJR,IDCI,IJII;MKJN,ADCA,MJIM;IKJR,IDCI,IJII;IKJR,EDCE,MJIM;IIHR,ECDE,MLKM;IKJR,ADCA,MJIM;EKJR,EDCE,QJIQ;EKJV,IDCI,MJIM;IKJR,EDCE,MJIM;MKJN,ADCA,MJIM;IIHR,ECDE,MLKM;EIHV,ECDE,QLKQ;EKJV,ADCA,QJIQ;EKJR,EDCE,QJIQ;IKJR,ADCA,QJIQ;IKJR,EDCE,IJII;MKJJ,ADCA,MJIM;MIHN,ECDE,ILKI;QKJJ,ADCA,EJIE;MKJJ,ELKE,AIJA;ICAJ,ELKE,IIJI;ECAR,ELKE,IIJI;EJKN,AKLA,MDCM;AJKR,CAAC,CAAA,EKLG,MDCM,KJII,GAAG,GAAG,YAAA;EAClB,EKLE,MDCM;IJKN,AKLA,QDCQ;ECAV,ELKE,MIJM;ECAR,ELKE,IIJI;ICAJ,ELKE,EIJE;ICAJ,ELKE,EIJE;ICAJ,ELKE,EIJE;MCAF,ADCA,EJIE;IIHJ,EJIE,AKLA;IACF,ADCA,EJIE;EKJJ,ADCA,MJIM;AKJR,CAAC,CAAA,ADCC,IJII;AIHN,CAAC,CAAA,MJIO,KIJI,GAAG,GAAG,4DAAA;EAChB,IJII;EIHJ,IJII;EIHJ,MJIM;EIHN,MJIM;IIHJ,MJIM;EIHR,QJIQ;EIHR,QJIQ;EIHR,QJIQ;EIHR,QJIQ;IIHN,IJII;MACF,AIJA;IJKF,EIJE;EJKJ,EIJE;AJKJ,CAAC,CAAA,IIJK,SJIQ,IAAI,GAAG,YAAA;EACnB,EIJE;IJKA,AIJA;IJKA,EIJE;IJKF,EIJE;MJKA,EIJE;MJKF,AIJA;QJKE,AIJA;MJKF,AIJA;IACF,EJIE;IIHF,IJII;IIHJ,EJIE;MIHA,EJIE;MACF,AIJA;MJKA,AIJA;IACF,IJII;EIHN,IJII;EIHJ,IJII;IIHF,IJII;IIHJ,IJII;MIHF,EJIE;MACF,AIJA;IJKF,EIJE;EJKJ,MIJM;AJKR,CAAC,CAAA,MIJO,OJIM,IAAI,GAAG,YAAA;EACnB,MIJM;IJKJ,MIJM;IJKN,MIJM;IJKN,QIJQ;MJKN,IIJI;QJKF,AIJA;MJKF,EIJE;IJKJ,IIJI;EJKN,IIJI;AJKN,CAAC,CAAA,EIJG;IACA;EACF;EACA;AACF,CAAC,CAAA","file":"all.min.js","sourcesContent":["// var angular = require('angular')\n// var ngRoute = require('angular-route')\n// var _ = require('underscore')\n\nangular.module('well', [\n  'ngRoute',\n  'ngAnimate',\n  'well.controllers',\n  'well.filters',\n  'well.services',\n  'well.directives',\n  'well.survey',\n  'well.tradeoff',\n  'well.overlap',\n  'well.instruct',\n  'well.results',\n  'well.instruct',\n  'well.admin'\n])\n.config(function ($routeProvider, $locationProvider) {\n  $routeProvider\n    .when('/', {\n      templateUrl: 'landing.html'\n    })\n    .when('/auth', {\n      templateUrl: 'auth.html'\n    })\n    .when('/consent', {\n      templateUrl: 'consent.html'\n    })\n    .when('/terms', {\n      templateUrl: 'terms.html'\n    })\n    .when('/privacy', {\n      templateUrl: 'privacy.html'\n    })\n    // survey\n    .when('/:module/survey', {\n      templateUrl: 'survey.html',\n      controller: 'SurveyCtrl'\n    })\n    .when('/sur', {\n      templateUrl: 'survey.html',\n      controller: 'SurveyCtrl'\n    })\n    .when('/transition', {\n      templateUrl: 'transition.html',\n      controller: 'TransCtrl'\n    })\n    // instructions\n    .when('/:module/instruct', {\n      templateUrl: 'instructions.html',\n      controller: 'InstructCtrl'\n    })\n    .when('/:module/instructions', {\n      templateUrl: 'instruct.html',\n      controller: 'InstructorCtrl'\n    })\n    // ThreeTwo Module\n    .when('/threetwo/abbcca', {\n      templateUrl: 'tradeoff.html',\n      controller: 'ThreeCtrl'\n    })\n    .when('/threetwo/dbec', {\n      templateUrl: 'tradeoff.html',\n      controller: 'TwoCtrl'\n    })\n    // Overlap Module\n    .when('/overlap/transition', {\n      templateUrl: 'transition.html',\n      controller: 'TransCtrl'\n    })\n    .when('/overlap/abac', {\n      templateUrl: 'tradeoff.html',\n      controller: 'AbacCtrl'\n    })\n    .when('/overlap/abc', {\n      templateUrl: 'overlap.html',\n      controller: 'AbcCtrl'\n    })\n    // Fine Overlap Module\n    .when('/fineoverlap/tradeoff', {\n      templateUrl: 'fineoverlap.html',\n      controller: 'FineCtrl'\n    })\n    // exit\n    .when('/:module/exit', {\n      templateUrl: 'exit.html',\n      controller: 'ExitCtrl'\n    })\n    // Misc\n    .when('/chart', {\n      templateUrl: 'chart.html',\n      controller: 'ChartCtrl'\n    })\n    .when('/dummy', {\n      templateUrl: 'dummy.html',\n      controller: 'DummyCtrl'\n    })\n    .when('/test', {\n      templateUrl: 'test.html',\n      controller: 'TestCtrl'\n    })\n    .when('/admin', {\n      templateUrl: 'admin.html',\n      controller: 'AdminCtrl'\n    })\n    .when('/anon', {\n      templateUrl: 'landing.html',\n      resolve: {\n        login: function (User) {\n          return User.loginAnon()\n        }\n      }\n    })\n    .otherwise({\n      redirectTo: '/'\n    })\n\n  // $locationProvider.html5Mode(true)\n})\n.run(function (User, $location, $http) {\n  if (!User.isAuthed() && $location.path() !== '/admin') $location.path('/')\n  // $http.jsonp('http://ipinfo.io/?callback=JSON_CALLBACK')\n  //   .success(function (response) {\n  //     console.log(response)\n  //   })\n  //   .error(function (error) {\n  //     console.log(error)\n  //   })\n})\n","/* Controllers */\n\nangular.module('well.controllers', [])\n  .controller('AppCtrl', function ($scope, $rootScope, $timeout, User, $location, Aspects, Survey, Font) {\n    $scope.font = Font    \n    $scope.aspects = {\n      texts: Aspects.texts\n    }\n    \n    $rootScope.$on('auth', () => {\n      Aspects.names().then(aspects => $scope.aspects.names = aspects)\n      User.getFontSize().then(size => Font.setSize(size))\n    })\n\n    Survey.getResponses()\n    $scope.responses = Survey.responses\n    $scope.user = User\n    User.isAdmin().then((isAdmin) => {\n      $scope.isAdmin = isAdmin\n    })\n\n    $scope.settings = {\n      devmode: false,\n      instruct: true\n    }\n\n    $scope.landing = {\n      url: 'preamble.html'\n    }\n\n    $scope.loc = $location\n\n    $scope.login = {\n      wrong: false,\n      placeholder: {\n        email: 'Enter your email',\n        password: 'Password'\n      },\n      submit: function () {\n        if (!$scope.login.email) {\n          $scope.login.wrong = 'INVALID_EMAIL'\n          $scope.login.placeholder.email = 'Enter a valid email'\n        } else if (!$scope.login.password) {\n          $scope.login.wrong = 'INVALID_PASSWORD'\n          $scope.login.placeholder.email = 'Enter a valid password'\n        } else {\n          User.login(this.email, this.password).then(function(user) {\n            $scope.login.wrong = 'in'\n            console.log('Logged in as: ', user.uid)\n            $scope.landing.url = 'modules.html'\n          }, function (error) {\n            $scope.login.wrong = error.code\n            if (error.code === 'INVALID_EMAIL') {\n              $scope.login.email = ''\n              $scope.login.placeholder.email = 'Enter a valid email'\n            } else if (error.code === 'INVALID_PASSWORD') {\n              $scope.login.password = ''\n              $scope.login.placeholder.password = 'Enter a valid password'\n            }\n            console.error('Login failed: ', error)\n          })\n        }\n      },\n      reset: () => {\n        if (!$scope.login.email) {\n          $scope.login.wrong = 'INVALID_EMAIL'\n          $scope.login.placeholder.email = 'Enter a valid email'\n        } else {\n          $scope.login.message = $scope.login.alert = ''\n          User.reset($scope.login.email).then(() => {\n            $scope.login.wrong = ''\n            $scope.login.message = 'We have sent an email with instructions to reset your password'\n          }, (error) => {\n            $scope.login.alert = error.message\n          })\n        }\n      }\n    }\n\n    $scope.signup = {\n      wrong: false,\n      placeholder: {\n        email: 'Enter your email',\n        password: 'Password',\n        confirm: 'Confirm password'\n      },\n      submit: function () {\n        if (!$scope.signup.email) {\n          $scope.signup.wrong = 'INVALID_EMAIL'\n          $scope.signup.placeholder.email = 'Enter a valid email'\n        } else if (!$scope.signup.password) {\n          $scope.signup.wrong = 'INVALID_PASSWORD'\n          $scope.signup.placeholder.email = 'Enter a valid password'\n        } else if ($scope.signup.password && $scope.signup.password && $scope.signup.password !== $scope.signup.confirm) {\n          $scope.signup.wrong = 'mismatch'\n          $scope.signup.confirm = ''\n        } else {\n          var promise = User.signup($scope.signup.email, $scope.signup.password)\n            .then(function () {\n              $timeout(() => $scope.landing.url = 'terms.html')\n            }, function (error) {\n              console.log(error)\n              $scope.signup.wrong = error.code\n              if (error.code === 'INVALID_EMAIL') {\n                $scope.signup.email = ''\n                $scope.signup.placeholder.email = 'Enter a valid email'\n              } else if (error.code === 'INVALID_PASSWORD') {\n                $scope.signup.password = ''\n                $scope.signup.placeholder.password = 'Enter a valid password'\n              } else if (error.code === 'EMAIL_TAKEN') {\n                $scope.signup.false = true\n                alert('The specified email address is already in use.')\n              }\n              console.error('Sign up failed: ', error)\n            })\n        }\n      },\n      agree: function () {\n        User.login($scope.signup.email, $scope.signup.password)\n          .then(function(user) {\n            $scope.login.wrong = 'in'\n            console.log('Logged in as: ', user.uid)\n            $scope.landing.url = 'modules.html'\n          }, function (error) {\n            console.log(error)\n          })\n      }\n    }\n\n    $scope.terms = {\n      agree: () => {\n        if (User.info && User.info.provider === 'anonymous') {\n          $scope.landing.url = 'modules.html'\n          $scope.terms.agreed = true\n        } else {\n          $scope.terms.agreed = true\n          User.login($scope.signup.email, $scope.signup.password)\n            .then(function(user) {\n              $scope.login.wrong = 'in'\n              console.log('Logged in as: ', user.uid)\n              $scope.landing.url = 'modules.html'\n            }, function (error) {\n              console.log(error)\n            })\n        }\n      }\n    }\n\n    $scope.cue = {\n      option: null,\n      deltaOne: 0,\n      deltaTwo: 0\n    }\n  })\n  // .controller('AuthCtrl', function ($scope, User, $location) {\n  //   if (User.info !== null) $location.path('survey')\n  // })\n  .controller('DummyCtrl', function ($scope) {\n    var aspects = ['Following your passion', 'Being acknowledged for your work', 'Being treated fairly', 'Having meaningful relationships', 'Having a sense of purpose']\n    $scope.pairs = _.map(aspects, function (a, i) {\n      return [a, aspects[(i + 1) % 5]]\n    })\n    $scope.levels = {}\n    _.each(aspects, function (a) {\n      $scope.levels[a] = Math.round( ( Math.random() * 35 ) + 60)\n    })\n    $scope.selections = {}\n    console.log($scope.pairs, $scope.levels)\n  })","/* Directives */\n\nangular.module('well.directives', [])\n  .directive('earth', function ($window, Aspects) {\n    return {\n      restrict: 'EA',\n      scope: {},\n      link: function (scope, element, attrs) {\n        window.onresize = function() {\n          scope.$apply()\n        }\n\n        scope.$watch(function() {\n          return angular.element($window)[0].innerWidth\n        }, function() {\n          scope.render()\n        })\n\n        var splash = d3.select('.splash')\n\n        scope.render = function () {\n          splash.selectAll('.earth *').remove()\n\n          var width = window.innerWidth,\n              height = window.innerHeight\n\n          var projection = d3.geo.orthographic()\n              .precision(0)\n              .scale(500)\n              .translate([width / 2, height / 2])\n              .clipAngle(180)\n\n          var canvas = d3.select('.splash .earth').append('canvas')\n              .attr('width', width)\n              .attr('height', height)\n\n          var context = canvas.node().getContext('2d')\n\n          var path = d3.geo.path()\n              .projection(projection)\n              .context(context)\n\n          var delta = 0\n          var offset = 0\n          var ln = d3.random.logNormal(1)\n          _.each(scope.responses, function (resp) {\n            resp.rand = Math.random() * 20 + 10\n          })\n\n          d3.json('world-110m.json', function(error, world) {\n            var x, y = 0\n            window.onscroll = function () {\n              y = (window.pageYOffset || document.scrollTop)  - (document.clientTop || 0) || 0\n              rotate()\n            }\n\n            d3.select('body').on('mousemove', function () {\n              x = d3.mouse(this)[0]\n              rotate()\n            })\n\n            var land = topojson.feature(world, world.objects.land)\n            var countries = topojson.feature(world, world.objects.countries).features\n\n            _.each(countries, function (country) {\n              country.properties.color = Math.random()\n            })\n            rotate()\n\n            function rotate () {\n              projection.rotate([x * .1, y * .1, 30])\n              context.clearRect(0, 0, width, height)\n\n              _.each(countries, function (country) {\n                context.beginPath()\n                context.strokeStyle = d3.hsl(country.properties.color * x, 1, .8).toString()\n                path(country)\n                context.stroke()\n              })\n            }\n          })\n        }\n      }\n    }\n  })\n  .directive('range', function($window, $timeout, Aspects) {\n    return {\n      restrict: 'EA',\n      scope: {\n        level: '='\n      },\n      link: function(scope, element, attrs) {\n        var svg = d3.select(element[0])\n          .append('svg')\n          .attr('width', '100%')\n          .attr('height', 22)\n\n        window.onresize = function() {\n          scope.$apply()\n        }\n\n        scope.$watch(function() {\n          return angular.element($window)[0].innerWidth\n        }, function() {\n          scope.render()\n        })\n\n        var lastLevel = null\n        scope.$watch('level', function (level) {\n          if (level !== lastLevel) {\n            scope.render()\n          }\n        })\n\n        scope.render = function () {\n          svg.selectAll('*').remove()\n\n          var width = d3.select(element[0])[0][0].offsetWidth\n          var height = 22\n\n          var x = d3.scale.linear()\n              .domain([0, 100])\n              .range([6, width - 6])\n              .clamp(true)\n\n          var brush = d3.svg.brush()\n              .x(x)\n              .extent([scope.level, scope.level])\n              .on('brush', brushed)\n\n          var axis = svg.append('g')\n              .attr('class', 'axis')\n\n          axis.call(d3.svg.axis()\n              .scale(x)\n              .orient('bottom')\n              .tickSize(0)\n              .tickValues([]))\n          \n          var domain = axis.select('.domain')\n              .attr('transform', 'translate(0, 10)')\n\n          domain.select(function() { return this.parentNode.appendChild(this.cloneNode(true)); })\n              .attr('class', 'halo')\n\n          var slider = svg.append('g')\n              .attr('class', 'slider')\n              .call(brush)\n\n          slider.selectAll('.extent,.resize')\n              .remove()\n\n          slider.select('.background')\n              .attr('height', height)\n\n          var pointy = function () {\n            var cx = x(1),\n              cy = 10\n            return {\n              set: function (pt) {\n                cx = pt\n                return [\n                  { x: cx - 6, y: cy - 6 },\n                  { x: cx + 6, y: cy - 6 },\n                  { x: cx + 6, y: cy + 6 },\n                  { x: cx, y: cy + 10 },\n                  { x: cx - 6, y: cy + 6 }\n                ]\n              }\n\n            }\n          }\n\n          var line = d3.svg.line()\n            .x(function (d) { return d.x })\n            .y(function (d) { return d.y })\n\n          var handle = slider.append('path')\n              .attr('class', 'handle')\n              .attr('d', line(pointy().set(x(scope.level))) + 'Z')\n              .style('display', 'none')\n\n          // slider\n          //     .call(brush.event)\n\n          function brushed() {\n            var value = brush.extent()[0]\n\n            var v = x.invert(d3.mouse(this)[0])\n            value = isNaN(v) ? value : v\n            brush.extent([value, value])\n\n            if (value) value = Math.round(value)\n\n            handle\n              .style('display', 'block')\n              .attr('d', line( pointy().set( x(value) ) ) + 'Z')\n            \n            lastLevel = value\n            $timeout(function () {\n              scope.level = value\n            })\n          }\n        }\n      }\n    }\n  })\n  .directive('bar', function($window, Aspects, $filter) {\n    return {\n      restrict: 'E',\n      scope: {\n        level: '=',\n        name: '=',\n        resize: '='\n      },\n      link: function(scope, element, attrs) {\n        var svg = d3.select(element[0])\n          .append('svg')\n          .attr('width', '100%')\n          .attr('height', 50)\n\n        var g = svg.append('g')\n\n        window.onresize = function() {\n          scope.$apply()\n        }\n\n        scope.$watch('level', function () {\n          scope.render()\n        })\n\n        scope.$watch('name', function () {\n          scope.render()\n        })\n\n        scope.$watch('resize', function () {\n          console.log('resize', scope.resize)\n          scope.render()\n        })\n\n        scope.$watch(function() {\n          return angular.element($window)[0].innerWidth\n        }, function() {\n          scope.render()\n        })\n\n        scope.render = function () {\n          g.selectAll('*').remove()\n\n          var w = d3.select(element[0])[0][0].offsetWidth\n          var width = w > 0 ? w : 100\n          var height = 40\n\n          var x = d3.scale.linear()\n              .domain([0, 100])\n              .range([6, width - 6])\n\n          var axis = g.append('g')\n              .attr('class', 'axis')\n              .attr('transform', 'translate(0,' + (height - 20) + ')')\n\n          axis.call(d3.svg.axis()\n              .scale(x)\n              .orient('bottom')\n              .tickSize(0)\n              .tickPadding(12))\n\n          axis.select('.domain').remove()\n\n          var backBar = g.append('rect')\n              .attr('class', 'backbar')\n              .attr('x', x(0))\n              .attr('y', 4)\n              .attr('height', 20)\n              .attr('width', x(100) - x(0))\n\n          var barBack = g.append('rect')\n              .attr('class', 'barBack')\n              .attr('x', x(0))\n              .attr('y', 4)\n              .attr('height', 20)\n              .attr('width', x(100) - x(0))\n              .style('fill', '#eee')\n\n          var bar = g.append('rect')\n              .attr('class', 'bar')\n              .attr('x', x(0))\n              .attr('y', 4)\n              .attr('height', 20)\n              .attr('width', x(scope.level) - x(0))\n              .style('fill', Aspects.getColor(scope.name, 100))\n\n          var text = g.append('text')\n              .attr('class', 'text')\n              .attr('y', 14)\n              .attr('dy', '.375em')\n              .style('fill', '#000')\n              .style('font-weight', '400')\n\n          var xPos = scope.diff ? x(scope.level + scope.diff) : x(scope.level)\n          \n          if (scope.level) {\n            g.append('line')\n                .attr('x1', xPos)\n                .attr('y1', 4)\n                .attr('x2', xPos)\n                .attr('y2', 24)\n                .style('stroke', '#000')\n          }\n        }\n      }\n    }\n  })\n  .directive('diff', function($window, Aspects, $filter, $timeout, Survey) {\n    return {\n      restrict: 'E',\n      scope: {\n        level: '=',\n        diff: '=',\n        name: '=',\n        choice: '=',\n        animate: '=',\n        delta: '=',\n        option: '@'\n      },\n      link: function(scope, element, attrs) {\n        var width = element[0].parentNode.getBoundingClientRect().width\n        var svg = d3.select(element[0])\n          .append('svg')\n          .attr('width', width)\n          .attr('height', 180)\n\n        var g = svg.append('g').attr('transform', 'translate(0,30)')\n        var zoom\n\n        window.addEventListener('resize', function() {\n          scope.render(true)\n        })\n\n        scope.$watch('level', function () {\n          scope.render()\n        })\n\n        scope.$watch('diff', function (diff) {\n          scope.render()\n        })\n\n        scope.$watch('name', function () {\n          scope.render()\n        })\n\n        var diffDur = 2000\n        var magDur = 1000\n\n        // scope.$watch('choice', function () {\n        //   if (attrs.option === 'one' && scope.name) {\n        //     scope.animate = 'one'\n        //     $timeout(() => { scope.animate = 'two' }, diffDur + magDur)\n        //   }\n        //   scope.render()\n        // }, true)\n\n        scope.$watch('animate', function () {\n          console.log('animate', scope.animate)\n          if (scope.name && scope.animate) {\n            scope.render(true)\n          }\n        })\n\n        var d = 0\n        var diffVal = 0\n\n        var range = [0, 100]\n        // scope.init = (animate) => {\n        //   if (range) {\n        //     scope.render(animate)\n        //   } else {\n        //     Survey.range().then(r => {\n        //       range = r\n        //       scope.render(animate)\n        //     })\n        //   }\n        // }\n\n        var scale = d3.select(element[0]).append('div').attr('class', 'scale')\n        scale.append('span').text('0').attr('class', 'left')\n        scale.append('span').text('100').attr('class', 'right')\n\n\n        scope.render = function (animate) {\n          width = element[0].parentNode.getBoundingClientRect().width\n          svg.attr('width', width)\n          // axis.attr('width', width)\n          g.selectAll('*').remove()\n          if (zoom) zoom.remove()\n\n          width -= 30\n          var height = 50\n          var top = 42\n\n          var x = d3.scale.linear()\n              .domain(range)\n              .range([21, width - 6])\n\n          // axis.call(d3.svg.axis()\n          //     .scale(x)\n          //     .orient('bottom')\n          //     .tickSize(0)\n          //     .tickPadding(12))\n\n          // axis.select('.domain').remove()\n\n          if(x(range[1]) - x(range[0]) > 0) {\n            var backBar = g.append('rect')\n                .attr('class', 'backbar')\n                .attr('x', x(range[0]))\n                .attr('y', top + 4)\n                .attr('height', 20)\n                .attr('width', x(range[1]) - x(range[0]))\n\n            var barBack = g.append('rect')\n                .attr('class', 'barBack')\n                .attr('x', x(range[0]))\n                .attr('y', top + 4)\n                .attr('height', 20)\n                .attr('width', x(range[1]) - x(range[0]))\n                .style('fill', '#eee')\n\n            var bar = g.append('rect')\n                .attr('class', 'bar')\n                .attr('x', x(range[0]))\n                .attr('y', top + 4)\n                .attr('height', 20)\n                .attr('width', x(scope.level) - x(range[0]))\n                .style('fill', Aspects.getColor(scope.name, 100))\n          }\n\n          var diff = g.append('rect')\n              .attr('class', 'diff')\n              .attr('y', top + 4)\n              .attr('height', 20)\n              .style('fill', Aspects.getColor(scope.name, 205))\n\n          var rightArrow = (start, end, y) => {\n            y += top\n            return 'M' + x(start) + ' ' + Number(y + 2) + ' L' + Number(x(end) - 4) + ' ' + Number(y + 2) +\n              ' L' + Number(x(end) - 4) + ' ' + y + ' L' + x(end) + ' ' + Number(y + 3) + ' L' + Number(x(end) - 4) + ' ' + Number(y + 6) +\n              ' L' + Number(x(end) - 4) + ' ' + Number(y + 4) + ' L' + x(start) + ' ' + Number(y + 4) + ' Z'\n          }\n\n          var leftArrow = (start, end, y) => {\n            y += top\n            return 'M' + x(start) + ' ' + Number(y + 2) + ' L' + Number(x(end) + 4) + ' ' + Number(y + 2) +\n              'L' + Number(x(end) + 4) + ' ' + y + ' L' + x(end) + ' ' + Number(y + 3) + ' L' + Number(x(end) + 4) + ' ' + Number(y + 6) +\n              'L' + Number(x(end) + 4) + ' ' + Number(y + 4) + ' L' + x(start) + ' ' + Number(y + 4) + ' Z'\n          }\n\n          var arrow = g.append('path')\n              .attr('class', 'arrow')\n              .attr('stroke', 'none')\n              .style('fill', '#000')\n\n          var text = g.append('text')\n              .attr('class', 'text')\n              .attr('y', top + 14)\n              .attr('dy', '.375em')\n              .style('fill', '#000')\n              .style('font-weight', '400')  \n\n          var xPos = scope.diff ? x(scope.level + scope.diff) : x(scope.level)\n          if (scope.level) {\n            g.append('line')\n              .attr('x1', xPos)\n              .attr('y1', top + 4)\n              .attr('x2', xPos)\n              .attr('y2', top + 24)\n              .style('stroke', '#000')\n          }\n\n          if (animate) {\n\n            if (scope.diff) {\n              var eight = x(12) - x(0)\n              zoom = svg.select(function() { return this.appendChild(this.cloneNode(true)) })\n                .attr('class','zoom')\n\n              var id = 'clip' + Math.random().toString().replace('.','')\n              var clip = zoom.append('defs').append('clipPath').attr('id', id)\n              clip.append('circle')\n                .attr('cx', xPos)\n                .attr('cy', top * 2)\n                .attr('r', eight)\n\n              zoom.insert('circle', 'g')\n                .attr('cx', xPos)\n                .attr('cy', top * 2)\n                .attr('r', eight)\n                .style('fill', '#fff')\n\n              zoom.append('circle')\n                .attr('cx', xPos)\n                .attr('cy', top * 2)\n                .attr('r', eight)\n                .style('fill', 'none')\n                .style('stroke','#000')\n                .style('stroke-width','2px')\n\n              var bounds = svg[0][0].getBoundingClientRect()\n              zoom\n                .attr('viewBox', xPos / 2 + ' ' + Number(top / 2 + 20) + ' ' + bounds.width / 2 + ' ' + bounds.height / 2)\n                .attr('clip-path', 'url(#' + id +')')\n                .transition()\n                .delay(1300)\n                .duration(magDur)\n                  .attr('viewBox', '0 0 ' + bounds.width + ' ' + bounds.height)\n                .each('end', () => zoom.remove())\n\n              bar\n                .style('fill-opacity', '0.6')\n                .transition()\n                .delay(1300)\n                .duration(magDur)\n                  .style('fill-opacity', '1')\n\n              d3.transition()\n                .delay(300)\n                .duration(diffDur)\n                  .tween('diff', () => {\n                    var i = d3.interpolateRound(0, scope.diff)\n                    return function(t) {\n                      $timeout(() => scope.delta = i(t))\n                    }\n                  })\n            }\n\n\n            if (scope.diff > 0) {\n              diffVal = scope.diff\n              d = x(scope.diff) - x(0)\n              svg.selectAll('.diff')\n                .attr('x', x(scope.level))\n                .attr('width', 0)\n                .transition()\n                .delay(300)\n                .duration(diffDur)\n                  .attr('width', d)\n\n              svg.selectAll('.arrow')\n                .attr('d', rightArrow(scope.level, scope.level, 11))\n                .transition()\n                .delay(300)\n                .duration(diffDur)\n                  .attr('d', rightArrow(scope.level, scope.level + scope.diff, 11))\n\n              svg.selectAll('.text').text('+' + $filter('round1')(scope.diff))\n              var w = text.style('width').replace('px','')\n\n              svg.selectAll('.text')\n                .attr('text-anchor', 'start')\n                .attr('x', x(scope.level + scope.diff))\n                .attr('dx', 4)\n            } else if (scope.diff < 0) {\n              diffVal = scope.diff\n              d = x(-scope.diff) - x(0)\n              svg.selectAll('.diff')\n                .attr('x', x(scope.level))\n                .attr('width', 0)\n                .style('fill', Aspects.getColor(scope.name, 40))\n                .transition()\n                .delay(300)\n                .duration(diffDur)\n                  .attr('x', x(scope.level) - d)\n                  .attr('width', d)\n\n              svg.selectAll('.arrow')\n                .attr('d', leftArrow(scope.level, scope.level, 11))\n                .transition()\n                .delay(300)\n                .duration(diffDur)\n                  .attr('d', leftArrow(scope.level, scope.level + scope.diff, 11))\n\n              svg.selectAll('.text').text($filter('round1')(scope.diff))\n\n              svg.selectAll('.text')\n                .attr('text-anchor', 'end')\n                .attr('dx', -4)\n                .attr('x', x(scope.level + scope.diff))\n            } else if (diffVal > 0) {\n              d = x(diffVal) - x(0)\n              svg.selectAll('.diff')\n                .attr('x', x(scope.level))\n                .attr('width', d)\n                .transition()\n                .duration(diffDur)\n                  .attr('width', 0)\n            } else if (diffVal < 0) {\n              d = x(-diffVal) - x(0)\n              svg.selectAll('.diff')\n                .attr('x', x(scope.level) - d)\n                .attr('width', d)\n                .style('fill', Aspects.getColor(scope.name, 40))\n                .transition()\n                .delay(300)\n                .duration(diffDur)\n                  .attr('x', x(scope.level))\n                  .attr('width', 0)\n            }\n          }\n        }\n      }\n    }\n  })\n  .directive('fix', function ($window) {\n    return {\n      restrict: 'EA',\n      scope: {},\n      link: function(scope, element, attrs) {\n        var div = d3.select(element[0])\n        var parent = d3.select(div[0][0].parentNode)\n\n        window.onresize = function() {\n          scope.$apply()\n        }\n\n        scope.$watch(function() {\n          return angular.element($window)[0].innerWidth\n        }, function() {\n          scope.render()\n        })\n\n        scope.render = function () {\n          var bounds = parent[0][0].getBoundingClientRect()\n          div.style({\n            'position': 'fixed',\n            'padding': parent.style('padding'),\n            'top': window.scrollTop ? bounds.top + window.scrollTop + 'px' : bounds.top + 'px',\n            'left': window.scrollLeft ? bounds.left + window.scrollLeft +  'px' : bounds.left + 'px',\n            'width': bounds.width + 'px'\n          })\n        }\n      }\n    }\n  })\n  .directive('prog', function ($window) {\n    return {\n      restrict: 'EA',\n      scope: {\n        complete: '='\n      },\n      link: function(scope, element, attrs) {\n         var svg = d3.select(element[0])\n          .append('svg')\n          .attr('width', '100%')\n          .attr('height', 8)\n\n        window.onresize = function() {\n          scope.$apply()\n        }\n\n        scope.$watch(function() {\n          return angular.element($window)[0].innerWidth\n        }, function() {\n          scope.render()\n        })\n\n        scope.$watch('complete', function () {\n          scope.render()\n        })\n\n        scope.render = function () {\n          svg.selectAll('*').remove()\n          var bounds = svg[0][0].getBoundingClientRect()\n          svg.append('rect')\n            .attr('height', 8)\n            .attr('width', bounds.width * scope.complete)\n            .attr('fill', '#559')\n        }\n      }\n    }\n  })\n  .directive('back', function (Aspects) {\n    return {\n      restrict: 'EA',\n      scope: {\n        name: '='\n      },\n      link: function(scope, element, attrs) {\n        scope.$watch('name', function (name) {\n          element[0].style.border = '1px solid ' + Aspects.getColor(name, 60)\n        })\n      }\n    }\n  })","/* Filters */\n\nangular.module('well.filters', [])\n  .filter('round2', function () {\n    return function (n) {\n      return Number(n).toFixed(2)\n    }\n  })\n  .filter('round1', function () {\n    return function (n) {\n      return n % 1 === 0 ? n : Number(n).toFixed(1)\n    }\n  })\n  .filter('percent', function () {\n    return function (n) {\n      return d3.format('%')(n)\n    }\n  })\n  .filter('capitalize', function () {\n    return function (string) {\n      return string ? string.charAt(0).toUpperCase() + string.slice(1) : ''\n    }\n  })\n  .filter('duration', function () {\n    return function (n) {\n      var s = Math.round(n / 1000)\n      return s < 10 ? '0:0' + s : '0:' + s\n    }\n  })\n  .filter('JSONify', function () {\n    return function (j) {\n      return JSON.stringify(j, null, 2)\n    }\n  })\n","/* Services */\n\nangular.module('well.services', [])\n  .factory('User', function ($q, $rootScope, $location, $timeout) {\n    var user = this\n    this.firebase = new Firebase('https://well.firebaseio.com/')\n    \n    this.info = this.firebase.getAuth()\n    this.isAuthed = () => {\n      return !!this.firebase.getAuth()\n    }\n\n    this.hashedEmail = email => \n      'wiaglif+' + CryptoJS.SHA3(email, { outputLength: 224 }).toString() + '@gmail.com'\n\n    this.signup = (email, password) => {\n      var deferred = $q.defer()\n\n      this.email = email\n      this.firebase.createUser({\n        email    : email, // this.hashedEmail(email)\n        password : password\n      }, error => {\n        if (error === null) {\n          console.log('User created successfully')\n          deferred.resolve()\n        } else {\n          console.log('Error creating user:', error)\n          deferred.reject(error)\n        }\n      })\n\n      return deferred.promise\n    }\n\n    this.login = (email, password) => {\n      var deferred = $q.defer()\n\n      this.email = email\n      this.firebase.authWithPassword({\n        email    : email, // this.hashedEmail(email)\n        password : password\n      }, (error, authData) => {\n        if (error === null) {\n          // user authenticated with Firebase\n          $timeout(function () {\n            user.info = authData\n          })\n          console.log('User ID: ' + authData.uid + ', Provider: ' + authData.provider)\n          deferred.resolve(authData)\n        } else {\n          console.log('Error authenticating user:', error)\n          deferred.reject(error)\n        }\n      })\n\n      return deferred.promise\n    }\n\n    this.loginAnon = () => {\n      var deferred = $q.defer()\n\n      this.firebase.authAnonymously((error, authData) => {\n        if (error) {\n          console.log('Error authenticating user:', error)\n          deferred.reject(error)\n        } else {\n          // user authenticated with Firebase\n          $timeout(function () {\n            console.log(authData)\n            user.info = authData\n          })\n          console.log('User ID: ' + authData.uid + ', Provider: ' + authData.provider)\n          deferred.resolve(authData)\n        }\n      })\n\n      return deferred.promise\n    }\n\n    this.reset = (email) => {\n      var deferred = $q.defer()\n\n      this.email = email\n      this.firebase.resetPassword({\n        email: email\n      }, (error) => {\n        if (error) {\n          deferred.reject(error)\n        } else {\n          deferred.resolve()\n        }\n      })\n\n      return deferred.promise\n    }\n\n    this.firebase.onAuth(auth => {\n      $timeout(() => {\n        $rootScope.$broadcast('auth')\n        user.info = auth\n      })\n    })\n\n    this.unauth = () => {\n      this.firebase.unauth()\n      user.info = null\n      window.location.href = window.location.href.split('#')[0]\n    }\n\n    this.setAspects = aspects => {\n      this.firebase.onAuth(auth => {\n        if (auth) user.firebase.child('aspects/' + auth.uid).set(aspects, () => user.aspects = aspects)\n      })\n    }\n\n    this.getAspects = () => {\n      var deferred = $q.defer()\n      if (this.aspects) {\n        deferred.resolve(this.aspects)\n      } else {\n        this.firebase.onAuth(auth => {\n          if (auth) user.firebase.child('aspects/' + auth.uid)\n            .on('value', snapshot => {\n              user.aspects = snapshot.val()\n              deferred.resolve(snapshot.val()) \n            })\n        })\n      }\n      return deferred.promise\n    }\n\n    this.addData = (module, data) => {\n      console.log(module, data)\n      this.firebase.onAuth(auth => {\n        console.log(auth)\n        if (auth) this.firebase.child('module/' + module + '/' + this.info.uid).push(data)\n      })\n    }\n\n    this.getData = (module, limit) => {\n      var deferred = $q.defer()\n      this.firebase.onAuth(auth => {\n        if (auth) this.firebase.child('module/' + module + '/' + this.info.uid)\n          .on('value', (snapshot) => deferred.resolve(snapshot.val()) )\n      })\n      return deferred.promise\n    }\n\n    this.getAllData = (module) => {\n      var deferred = $q.defer()\n      this.firebase.onAuth(auth => {\n        if (auth) this.firebase.child('module/' + module)\n          .on('value', (snapshot) => deferred.resolve(snapshot.val()) )\n      })\n      return deferred.promise\n    }\n\n    this.isAdmin = () => {\n      var deferred = $q.defer()\n      this.firebase.onAuth(auth => {\n        if (auth) this.firebase.child('admins')\n          .on('value', (snapshot) => {\n            var admins = Object.keys(snapshot.val())\n            var userNum = auth.uid.replace('simplelogin:','')\n            deferred.resolve(_.contains(admins, userNum))\n          })\n      })\n      return deferred.promise    \n    }\n\n    this.saveFontSize = (size) => {\n      this.firebase.onAuth(auth => {\n        if (auth) this.firebase.child('font/' + this.info.uid).set(size)\n      })\n    }\n\n    this.getFontSize = () => {\n      var deferred = $q.defer()\n      this.firebase.onAuth(auth => {\n        if (auth) this.firebase.child('font/' + this.info.uid)\n          .on('value', (snapshot) => deferred.resolve(snapshot.val()) )\n      })\n      return deferred.promise\n    }\n\n    return this\n  })\n  .factory('Aspects', function (User, $q, $location) {\n    this.texts = {\n      'Family Well-Being': 'the overall well-being of you and your family',\n      'Family Happiness': 'your and your familyâ€™s happiness',\n      'Health': 'your health (physical and mental)',\n      'Morality': 'your morality (that is, living up to your personal values)',\n      'Family Relationships': 'your family relationships',\n      'Financial Security': 'your financial security',\n      'Options & Possibilities': 'your options and possibilities in life',\n      'Meaning & Value': 'your sense that your life is meaningful and has value',\n      'Life Satisfaction': 'how satisfied you are with your life',\n      'Enough Time & Money': 'your feeling that you have enough time and money',\n      'Peace, Calm & Harmony': 'how peaceful, calm, and harmonious your life is',\n      'Independence': 'your feeling of independence and self-sufficiency',\n      'Making a Difference': 'your sense that you are making a difference in the world',\n      'Worthwileness': 'your feeling that the things you do are worthwhile',\n      'Safety & Security': 'your physical safety and security',\n      'Respect': 'your being treated with dignity and respect by others',\n      'Amount of Day Happy': 'how much of the time you feel happy',\n      'Improvement': 'your sense that things are getting better and better',\n      'Overall Happiness': 'how happy you are overall with your life',\n      'Life Longevity': 'your chance to live a long life'\n    }\n\n    var five = _.sample(Object.keys(this.texts), 5)\n    this.names = () => {\n      var deferred = $q.defer()\n      User.getAspects().then(aspects => {\n        var as\n        if ($location.path().split('/')[1].indexOf('overlap') !== -1) {\n          as = aspects.slice(0,3)\n        } else {\n          as = aspects\n        }\n        console.log(aspects, as, five)\n        if (aspects) {\n          deferred.resolve(as)\n        } else {\n          User.setAspects(five)\n          deferred.resolve(as)\n        }\n      })\n      return deferred.promise\n    }\n\n    this.getColor = (aspect, level) => {\n      if (User.aspects) {\n        var h = (User.aspects.indexOf(aspect) + 6) * 70,\n          l =  .99 + (level / 100) * -.24\n        return d3.hsl(h, .8, l).toString()\n      }\n    }\n\n    return this\n  })\n  .factory('Style', function ($window) {\n    var sheet = (function() {\n      var style = document.createElement('style')\n\n      // Add a media (and/or media query) here if you'd like!\n      // style.setAttribute(\"media\", \"screen\")\n      // style.setAttribute(\"media\", \"@media only screen and (max-width : 1024px)\")\n\n      // WebKit hack :(\n      style.appendChild(document.createTextNode(''))\n\n      document.head.appendChild(style)\n\n      return style.sheet\n    })()\n\n    return function (selector, rules, index) {\n      if (sheet.insertRule) {\n        sheet.insertRule(selector + '{' + rules + '}', index);\n      } else {\n        sheet.addRule(selector, rules, index);\n      }\n    }\n  })\n  .factory('Slide', function () {\n    return function (element, duration) {\n      var neu = d3.select(element).style('opacity', '0')\n      var w = neu.style('width')\n\n      var old = neu.select(function() { return this.parentNode.insertBefore(this.cloneNode(true), this) })\n          .style('opacity', '1')\n\n      var parent = neu.select(function () { return this.parentNode })\n\n      parent.style('pointer-events', 'none')\n\n      old\n        .transition()\n          .duration(duration)\n          .style('left', '-' + w)\n          .style('opacity', '0')\n          .each('end', function () {\n            old.remove()\n            parent.style('pointer-events', 'auto')\n          })\n\n      neu\n        .transition()\n          .duration(duration)\n          .style('left', '-' + w)\n          .style('opacity', '1')\n          .each('end', function () {\n            neu.style('left', '0px')\n          })\n    }\n  })\n  .factory('Font', function (User) {\n\n    this.level = 0\n    \n    this.getSize = () => window.getComputedStyle(document.body).fontSize.replace('px', '') / 10\n    \n    this.decreaseSize = () => {\n      if (this.level > -3) this.level--\n      var size = Math.pow(1.25, this.level) * 1.75 + 'em'\n      document.body.style.fontSize = size\n      User.saveFontSize(this.level)\n    }\n\n    this.increaseSize = () => {\n      if (this.level < 3) this.level++\n      var size = Math.pow(1.25, this.level) * 1.75 + 'em'\n      document.body.style.fontSize = size\n      User.saveFontSize(this.level)\n    }\n\n    this.setSize = level => {\n      this.level = level\n      document.body.style.fontSize = Math.pow(1.25, this.level) * 1.75  + 'em'\n    }\n\n    return this\n  })","angular.module('well.survey', [])\n  .controller('ResultsCtrl', function ($scope, Aspects, Survey, Choices, User) {\n    $scope.weights = Choices.weights()\n    $scope.aspects.sorted = _.sortBy($scope.aspects.names, function (n) {\n      return $scope.weights[n] * -1\n    })\n\n    $scope.data = User.getData('threetwo')\n    \n    // generate some dummy data for testing\n    if (!$scope.weights) {\n      $scope.weights = {}\n      _.each($scope.aspects.names, function (a) {\n        $scope.weights[a] = Math.random()\n      })\n      console.log($scope.weights)\n\n      var sumW = 0\n       _.each($scope.aspects.names, function (a) {\n        sumW += $scope.weights[a]\n      })\n\n      _.each($scope.aspects.names, function (a) {\n        $scope.weights[a] = $scope.weights[a] / sumW\n      })\n    }\n  })\n  .controller('SurveyCtrl', function ($scope, Aspects, Survey, Style, $location, $routeParams, Trans) {\n    Aspects.names().then(aspects => {\n      $scope.aspects.names = aspects\n      Survey.aspects = aspects\n    })\n\n    $scope.survey = {\n      finished: false\n    }\n\n    $scope.$watch('responses', function () {\n      if (Survey.responded()) {\n        $scope.survey.finished = true\n      }\n    }, true)\n\n    $scope.next = function () {\n      switch ($location.path().split('/')[1]) {\n        case 'threetwo':\n          $location.path('threetwo/instructions')\n          break\n        case 'overlap':\n          $location.path('overlap/instructions')\n          break\n        case 'fineoverlap':\n          $location.path('fineoverlap/instructions')\n          break\n      }\n    }\n  })\n  .factory('Survey', function (Aspects, $q) {\n    var survey = this\n    this.responses = {}\n\n    this.getResponses = () => {\n      var deferred = $q.defer()\n\n      if (this.aspects) {\n        deferred.resolve(survey.responses)\n      } else {\n        Aspects.names().then(aspects => {\n          survey.aspects = aspects\n          _.each(aspects, function (a) {\n            if (!survey.responses[a]) survey.responses[a] = null\n          })\n          deferred.resolve(survey.responses)\n        })\n      }\n      return deferred.promise\n    }\n\n    this.respond = (aspect, level) => this.responses[aspect] = level\n\n    this.responded = () => this.aspects && _.every(survey.aspects, a => survey.responses[a])\n\n    this.randomize = () => {\n      console.log('randomized')\n      var deferred = $q.defer()\n      this.getResponses().then(responses => {\n        Aspects.names().then(aspects => {\n          for (var i in aspects) {\n            survey.responses[aspects[i]] = Math.max( Math.ceil(Math.random() * 99), Math.max( Math.ceil(Math.random() * 99), Math.ceil(Math.random() * 99) ) )\n          }\n\n          deferred.resolve(survey.responses)\n        })\n      })\n      return deferred.promise\n    }\n\n    this.safeRandomize = () => {\n      if (this.responded()) { \n        return this.getResponses()\n      } else {\n        return this.randomize()\n      }\n    }\n\n    this.reset = () => {\n      if (this.aspects) _.each(survey.aspects, a => {\n        survey.responses[a] = null\n      })\n      return this.responses\n    }\n\n    this.minMax = null\n    this.range = () => {\n      var deferred = $q.defer()\n      if (this.minMax) {\n        deferred.resolve(this.minMax)\n      } else {\n        this.safeRandomize().then(responses => {\n          var values = _.map(responses, r => r)\n          var min = Math.max(0, _.min(values) - 8)\n          var max = Math.min(100, _.max(values) + 8)\n          this.minMax = [min, max]\n          console.log(this.minMax)\n          deferred.resolve(this.minMax)\n        })\n      }\n      return deferred.promise\n    }\n\n    return this\n  })\n  .controller('TransCtrl', function ($scope, Aspects, Survey, Trans, $rootScope, $timeout) {\n    Aspects.names().then(aspects => {\n      $scope.aspects.names = aspects\n      Survey.aspects = aspects\n    })\n    Survey.safeRandomize().then(res => {\n      // Trans.ition()\n    })\n\n    $scope.resize = false\n    $rootScope.$on('trans:change', () => {\n      $timeout(() => $scope.resize = !$scope.resize )\n    })\n  })\n  .factory('Trans', function ($timeout, $rootScope, Style) {\n    var trans = this\n\n    this.ition = () => {\n      setTimeout(() => {\n        d3.select('.option .panel').insert('h3', 'li')\n        d3.selectAll('range')\n          .style('opacity', 1)\n          .transition()\n          .duration(1000)\n            .style('opacity', 0)\n            .remove()\n          .each('end', () => {\n            d3.select('.option h3').text('Option 1')\n          })\n\n       d3.selectAll('.axis text')\n          .filter(d => d > 0 && d < 100)\n          .style('opacity', 1)\n          .transition()\n          .duration(1000)\n            .style('opacity', 0)\n          .each('end', () => {\n            Style('.axis .tick', 'display:none;')\n            Style('.axis .tick:first-child, .axis .tick:last-child', 'display:block;')\n          })\n\n        d3.selectAll('range svg')\n          .style('height', 20)\n          .transition()\n          .duration(1000)\n            .style('height', 0)\n\n        var width = d3.select('.option').style('width').replace('px','')\n        d3.select('.option')\n          .style('width', width + 'px')\n          .transition()\n          .delay(1000)\n          .duration(1000)\n            .style('width', width / 2 + 'px')\n            .tween('event', () => {\n              return function(t) {\n                $rootScope.$broadcast('trans:change')\n              }\n            })\n\n      }, 1)\n    }\n    return trans\n  })","angular.module('well.tradeoff', [])\n  //\n  // --------------------------------------------------\n  //\n  //                  CONTROLLERS\n  //\n  // --------------------------------------------------\n  //\n  .controller('ThreeCtrl', function ($scope, Choices, Tradeoff, Three, Two, Slide, $location, $routeParams, $timeout) {\n    $scope.choice = {}\n    $scope.choices = Choices\n    $scope.tradeoff = Tradeoff\n    $scope.animate = {\n      one: false,\n      two: false\n    }\n\n    var reanimate = () => {\n      $scope.animate.one = $scope.animate.two = false\n      $timeout(() => $scope.animate.one = true, 1)\n      $timeout(() => $scope.animate.two = true, 3000)\n    }\n\n    $scope.hidePreamble = () => {\n      Tradeoff.preamble = false\n      setTimeout(() => {\n        Three.loadChoice().then(choice => {\n          $scope.choice = choice\n          reanimate()\n        })\n      }, 1)\n    }\n\n    if (!Tradeoff.preamble) {\n      Three.loadChoice().then(choice => {\n        $scope.choice = choice\n        reanimate()\n      })\n    }\n\n    $scope.choose = function (i) {\n      $scope.choice = Three.choose(i)\n      Slide('.options', 300)\n      reanimate()\n    }\n\n    // the last choice returns false\n    $scope.$watch('choice', function (c) {\n      $scope.choices = Choices\n      $scope.completed = Choices.step++ / (Three.numberOfQs + Two.numberOfQs)\n      if (!c) {\n        $location.path('threetwo/dbec')\n      }\n    })\n  })\n  .controller('TwoCtrl', function ($scope, Choices, Two, Three, Slide, User, $location, $timeout) {\n    $scope.choice = true\n    $scope.choices = Choices\n    $scope.animate = {\n      one: false,\n      two: false\n    }\n\n    var reanimate = () => {\n      $scope.animate.one = $scope.animate.two = false\n      $timeout(() => $scope.animate.one = true, 1)\n      $timeout(() => $scope.animate.two = true, 3000)\n    }\n\n    Two.loadChoice().then(choice => {\n      $scope.choice = choice\n      reanimate()\n    })\n\n    $scope.choose = function (i) {\n      $scope.choice = Two.choose(i)\n      Slide('.options', 300)\n      reanimate()\n    }\n\n    // the last choice returns false\n    $scope.$watch('choice', function (c) {\n      $scope.choices = Choices\n      $scope.completed = Choices.step++ / (Three.numberOfQs + Two.numberOfQs)\n      if (!c) {\n        if (User.info.provider === 'password') {\n          // user is authenticated with email and password\n          Choices.submit()\n          $location.path('threetwo/exit')\n        } else {\n          $location.path('threetwo/exit')\n        }\n      }\n    })\n  })\n  .controller('TestCtrl', function ($scope, Choices, Two, Three, Slide, User, $location) {\n    $scope.choice = true\n    $scope.choices = Choices\n\n    $scope.options = {\n      one: 0,\n      two: 0,\n      choice: null,\n      highlight: n => {\n        if (!$scope.options.choice) {\n          if (n === 1) {\n            $scope.options.one = $scope.choice.tradeoff[0]\n            $scope.options.two = 0\n          } else {\n            $scope.options.two = $scope.choice.tradeoff[1]\n            $scope.options.one = 0\n          }\n        }\n      },\n      select: n => {\n        $scope.options.choice = n\n        if (n === 1) {\n          $scope.options.one = $scope.choice.tradeoff[0]\n          $scope.options.two = 0\n        } else {\n          $scope.options.two = $scope.choice.tradeoff[1]\n          $scope.options.one = 0\n        }\n      },\n      reset: () => {\n        if (!$scope.options.choice) $scope.options.one = $scope.options.two = 0\n      }\n    }\n\n    Two.loadChoice().then(choice => {\n      $scope.choice = choice\n    })\n\n    $scope.choose = function () {\n      var i = $scope.options.one ? $scope.choice.i *  2 + 1 : $scope.choice.i *  2 + 2\n      $scope.choice = Two.choose(i)\n      $scope.options.choice = null\n      $scope.options.reset()\n      Slide('.scenario', 300)\n    }\n\n    // the last choice returns false\n    $scope.$watch('choice', function (c) {\n      $scope.choices = Choices\n      $scope.completed = Choices.step++ / Two.numberOfQs\n      if (!c) {\n        $location.path('threetwo/exit')\n      }\n    })\n\n  })\n  .controller('CompleteCtrl', function ($scope, User, Choices, $location) {\n    $scope.login = {\n      wrong: false,\n      placeholder: {\n        email: 'Enter your email',\n        password: 'Password'\n      },\n      submit: function() {\n        if (!$scope.login.email) {\n          $scope.login.wrong = 'INVALID_EMAIL'\n          $scope.login.placeholder.email = 'Enter a valid email'\n        } else if (!$scope.login.password) {\n          $scope.login.wrong = 'INVALID_PASSWORD'\n          $scope.login.placeholder.email = 'Enter a valid password'\n        } else {\n          User.login(this.email, this.password).then(function(user) {\n            $scope.login.wrong = 'in'\n            console.log('Logged in as: ', user.uid)\n            Choices.submit()\n            $location.path('results')\n          }, function(error) {\n            $scope.login.wrong = error.code\n            if (error.code === 'INVALID_EMAIL') {\n              $scope.login.email = ''\n              $scope.login.placeholder.email = 'Enter a valid email'\n            } else if (error.code === 'INVALID_PASSWORD') {\n              $scope.login.password = ''\n              $scope.login.placeholder.password = 'Enter a valid password'\n            }\n            console.error('Login failed: ', error)\n          })\n        }\n      }\n    }\n  })\n  //\n  // --------------------------------------------------\n  //\n  //                  SERVICES\n  //\n  // --------------------------------------------------\n  //\n  .factory('Tradeoff', function () {\n    var tradeoff = {}\n    // randomly decide whether to display positive or negative tradeoffs\n    tradeoff.sign = Math.random() > 0.5 ? 'positive' : 'negative'\n    console.log(tradeoff.sign)\n    tradeoff.preamble = Math.random() > 0.5\n    // 2 * i + 1 || 2 * i + 2\n    // Each tuple represents the change in Option 1 for aspect X and the change in Option 2 for aspect Y respectively \n    tradeoff.positive_tradeoffs = [         \n                                  [4,4],\n                    [1,4],                   [4,1],\n              [1,8],       [2,4],      [4,2],      [8,1],\n      // MRS range based on final tradeoff where each number represents the MRS of Y in terms of X as a power of 2\n      // <--- indicates relative pref for X   ---> indicates pref for Y\n      [-4,-3],[-3,-2],[-2,-1],[-1,0],[0,1],[1,2],[2,3],[3,4]\n    ]\n\n    // The negative tradeoffs have the reverse mapping as the positive ones\n    tradeoff.negative_tradeoffs = [         \n                            [-4,-4],\n              [-4,-1],                 [-1,-4],\n          [-8,-1],    [-4,-2],    [-2,-4],   [-1,-8],\n      [3,4],[2,3],[1,2],[0,1],[-1,0],[-2,-1],[-3,-2],[-4,-3]\n    ]\n\n    // where a and b are the rating levels for aspects a and b\n    tradeoff.checkCorners = function (a, b) {\n      if (a > 92 && b < 8) {\n        return 'skip'\n      } else if (a < 8 && b > 92) {\n        return 'skip'\n      } else if (a > 92 || b > 92) {\n        return 'negative'\n      } else if (a < 8 || b < 8) {\n        return 'positive'\n      } else {\n        return null\n      }\n    }\n\n    // where a and b are the rating levels for aspects a and b\n    tradeoff.values = function (a, b) {\n      var s = this.checkCorners(a, b) === null ? this.sign : this.checkCorners(a, b)\n      if (s === 'positive') {\n        return this.positive_tradeoffs\n      } else if (s === 'negative') {\n        return this.negative_tradeoffs\n      } else {\n        return 'skip'\n      }\n    }\n    return tradeoff\n  })\n  // The Choices service records decisions and generates MRS values / weights\n  .factory('Choices', function (Aspects, Survey, Tradeoff, User) {\n    var aspects\n    var choices = {\n      MRS: {}\n    }\n\n    Aspects.names().then(names => {\n      aspects = names\n      _.each(aspects, function (aspect) {\n        choices.MRS[aspect] = {}\n      })\n    })\n\n    choices.step = 0\n    choices.levels = Survey.responses\n    choices.sign = Tradeoff.sign\n    choices.skipped = []\n    choices.decisions = []\n\n    // add MRS value where d is the denomitar aspect, n the numerator and v the value as a power of 2\n    choices.addMRS = function (n, d, range) {\n      this.MRS[d][n] = (range[0] + range[1]) / 2\n      this.MRS[n][d] = (range[0] + range[1]) / -2\n    }\n\n    // compute the MRS value of aspect n in terms of d, assuming one step of transitivity if necessary\n    choices.getMRS = function (n, d) {\n      if (d === n) {\n        return 0\n      } else if (this.MRS[d][n]) {\n        return this.MRS[d][n]\n      } else if (Object.keys(this.MRS[d]).length) {\n        // check if there's an alternative route to n\n        var alt = _.find(Object.keys(choices.MRS[d]), function (alt) {\n          return choices.MRS[alt][n]\n        })\n        if (alt) {\n          return choices.MRS[d][alt] + choices.MRS[alt][n]\n        } else {\n          return false\n        }\n      } else {\n        return false\n      }\n    }\n\n    // records each decision\n    choices.record = function (pair, i) {\n      this.decisions.push({\n        aspects: pair,\n        i: i,\n        t: Date.now()\n      })\n\n      // if this is a final tradeoff\n      if (i > 6) {\n        // MRS of pair[1] in terms of pair[0]\n        this.addMRS(pair[1], pair[0], Tradeoff.values(this.levels[pair[0]], this.levels[pair[1]])[i])\n      }\n    }\n\n    choices.weights = function () {\n      var sum = 0\n      var ws = _.map(aspects, function (a) {\n        var mrs = choices.getMRS(a, aspects[0])\n        sum += Math.pow(2, mrs)\n        return Math.pow(2, mrs)\n      })\n\n      var weights = {}\n      _.each(aspects, function (aspect, i) {\n        weights[aspect] = ws[i] / sum\n      })\n      return weights\n    }\n\n    choices.submit = function () {\n      User.addData('threetwo', {\n        date: Date.now(),\n        aspects: aspects,\n        responses: choices.levels,\n        decisions: choices.decisions,\n        skipped: choices.skipped,\n        MRS: choices.MRS,\n        weights: choices.weights()\n      })\n    }\n\n    return choices\n  })\n  .factory('Three', function (Aspects, Survey, Tradeoff, Choices, $q) {\n    var three = this\n    this.pair = null\n    this.numberOfQs = 9\n    var aspects\n    var responses\n\n    this.choose = (i) => {\n      console.log(responses)\n      if (!i) {\n        i = 0\n        this.pair = this.pairs.shift()\n      } else {\n        Choices.record(this.pair, i)\n      }\n\n      if (i > 6) {\n        i = 0\n        if (this.pairs.length) {\n          this.pair = this.pairs.shift()\n        } else {\n          return false\n        }\n      }\n\n      var tradeoff = Tradeoff.values(responses[this.pair[0]], responses[this.pair[1]])\n\n      return three.choice = {\n        aspects: this.pair,\n        tradeoff: tradeoff[i],\n        i: i\n      }\n    }\n\n    this.loadChoice = () => {\n      var deferred = $q.defer()\n      Aspects.names().then(names => {\n        aspects = names\n        three.aspects = [aspects[0], aspects[1], aspects[2]]\n\n        Survey.safeRandomize().then(res => {\n          responses = res\n          three.pairs = _.map(three.aspects, function (aspect, i) {\n            return [three.aspects[i], three.aspects[(i + 1) % 3]]\n          })\n\n          three.pairs = _.filter(three.pairs, function (pair) {\n            var skip = Tradeoff.values(responses[pair[0]], responses[pair[1]]) === 'skip'\n            if (skip) Choices.skipped.push(pair)\n            return !skip\n          })\n\n          three.numberOfQs = three.pairs.length * 3\n          console.log(res, responses)\n          deferred.resolve(three.choose(0))\n        })\n      })\n      return deferred.promise\n    }\n\n    return this\n  })\n  .factory('Two', function (Aspects, Survey, Tradeoff, Choices, Three, $q) {\n    var aspects\n    var responses\n    if (!Survey.responded()) Survey.randomize()\n    var two = this\n    this.pair = null\n\n    this.numberOfQs = 6\n\n    this.choose = (i) => {\n      if (!i) {\n        i = 0\n        this.pair = this.pairs.shift()\n      } else {\n        Choices.record(this.pair, i)\n      }\n\n      if (i > 6) {\n        i = 0\n        if (this.pairs.length) {\n          this.pair = this.pairs.shift()\n        } else {\n          return false\n        }\n      }\n\n      var tradeoff = Tradeoff.values(responses[this.pair[0]], responses[this.pair[1]])\n      return {\n        aspects: this.pair,\n        tradeoff: tradeoff[i],\n        i: i\n      }\n    }\n\n    this.loadChoice = () => {\n      var deferred = $q.defer()\n      Aspects.names().then(names => {\n        aspects = names\n        two.aspects = _.difference(aspects, Three.aspects)\n\n        Survey.safeRandomize().then(res => {\n          responses = res\n          two.pairs = [ [aspects[3], aspects[1]], [aspects[4], aspects[2]] ] \n          two.pairs = _.filter(two.pairs, function (pair) {\n            var skip = Tradeoff.values(responses[pair[0]], responses[pair[1]]) === 'skip'\n            if (skip) Choices.skipped.push(pair)\n            return !skip\n          })\n\n          two.numberOfQs = two.pairs.length * 3\n          deferred.resolve(two.choose())\n        })\n      })\n\n      return deferred.promise\n    }\n\n    return this\n  })","angular.module('well.overlap', [])\n  .factory('Overlap', function (User, Aspects, Survey) {\n    var overlap = this\n    this.doubled = Math.random() > 0.5\n    this.preamble = Math.random() > 0.5\n    this.decisions = []\n    this.skipped = []\n\n    this.record = (decision) => {\n      this.decisions.push(decision)\n    }\n\n    this.submit = () => {\n      console.log('submit')\n      Aspects.names().then(aspects => {\n        Survey.getResponses().then(responses => {\n          console.log(aspects, responses)\n          User.addData('overlap', {\n            date: Date.now(),\n            aspects: aspects,\n            responses: responses,\n            decisions: overlap.decisions,\n            skipped: overlap.skipped\n          })\n        })\n      })\n    }\n\n    return overlap\n  })\n  .factory('Abc', function (Overlap, Choices, Tradeoff, Survey, Aspects, $q) {\n    var responses\n    var abc = {}\n    abc.MRS = {}\n\n    abc.positiveOK = function (a, b, c) {\n      return a < 93 && b < 93 && c < 93\n    }\n\n    abc.negativeOK = function (a, b, c) {\n      return a > 8 && b > 8 && c > 8\n    }\n\n    abc.getSign = function (a, b, c) {\n      var sign = Tradeoff.sign\n      if (sign === 'positive') {\n        if (this.positiveOK(a, b, c)) {\n          return 'positive'\n        } else if (this.negativeOK(a, b, c)) {\n          return 'negative'\n        } else {\n          return false\n        }\n      } else if (sign === 'negative') {\n        if (this.negativeOK(a, b, c)) {\n          return 'negative'\n        } else if (this.positiveOK(a, b, c)) {\n          return 'positive'\n        } else {\n          return false\n        }\n      }\n    }\n\n    abc.choose = function (i) {\n      Overlap.record({\n        aspects: abc.aspects,\n        i: i,\n        t: Date.now()\n      })\n\n      var sign = this.getSign(responses[abc.aspects[0]], responses[abc.aspects[1]], responses[abc.aspects[2]])\n      // check corner case and if tradeoff value > 8, i.e. [-8, -1] or [8, 1]\n      if (!sign || i > 6 || sign === 'negative' && i === 3 && Overlap.doubled || sign === 'positive' && i === 6 && Overlap.doubled) {\n        return false\n      } else if (sign === 'positive') {\n        return {\n          aspects: this.aspects,\n          tradeoff: Tradeoff.positive_tradeoffs[i],\n          i: i\n        }\n      } else if (sign === 'negative') {\n        return {\n          aspects: this.aspects,\n          tradeoff: Tradeoff.negative_tradeoffs[i],\n          i: i\n        }\n      }\n    }\n\n    abc.loadChoice = () => {\n      var deferred = $q.defer()\n      Aspects.names().then(aspects => {\n        abc.aspects = [aspects[0], aspects[1], aspects[2]]\n        _.each(abc.aspects, function (a) {\n          abc.MRS[a] = {}\n          _.each(abc.aspects, function (b) {\n            var mrs = Choices.getMRS(a, b)\n            // for testing set MRS to 0, i.e. 2^0\n            abc.MRS[a][b] = mrs ? mrs : 0\n          })\n        })\n\n        Survey.safeRandomize().then(res => {\n          responses = res\n          deferred.resolve(abc.choose(0))\n        })\n      })\n      return deferred.promise\n    }\n\n    return abc\n  })\n  .factory('Abac', function (Aspects, Survey, Overlap, Tradeoff, Choices, $q) {\n    var abac = this\n    this.pair = null\n    var aspects\n    var responses\n    if (!Survey.responded()) Survey.randomize()\n\n    this.choose = (i) => {\n      Overlap.record({\n        aspects: abac.aspects,\n        i: i,\n        t: Date.now()\n      })\n\n      if (!i) {\n        i = 0\n        this.pair = this.pairs.shift()\n      } else {\n        Choices.record(this.pair, i)\n      }\n\n      if (i > 6) {\n        i = 0\n        if (this.pairs.length) {\n          this.pair = this.pairs.shift()\n        } else {\n          return false\n        }\n      }\n\n      var tradeoff = Tradeoff.values(responses[this.pair[0]], responses[this.pair[1]])\n      \n      return abac.choice = {\n        aspects: this.pair,\n        tradeoff: tradeoff[i],\n        i: i\n      }\n    }\n\n    this.loadChoice = () => {\n      var deferred = $q.defer()\n      Aspects.names().then(names => {\n        aspects = names\n        abac.aspects = [aspects[0], aspects[1], aspects[2]]\n\n        Survey.getResponses().then(res => {\n          responses = res\n          abac.pairs = [\n            [aspects[0], aspects[1]],\n            [aspects[0], aspects[2]]\n          ]\n\n          abac.pairs = _.filter(abac.pairs, function (pair) {\n            var skip = Tradeoff.values(responses[pair[0]], responses[pair[1]]) === 'skip'\n            if (skip) Overlap.skipped.push(pair)\n            return !skip\n          })\n\n          abac.numberOfQs = abac.pairs.length * 3\n          deferred.resolve(abac.choose(0))\n        })\n      })\n      return deferred.promise\n    }\n\n    return this\n  })\n  .factory('Fine', function (Aspects, Survey, Overlap, Abc, $q, User) {\n    var fine = this\n    this.tuple = []\n    var aspects\n    var responses\n    this.done = {}\n    this.decisions = []\n    this.positive = null\n\n    this.choose = i => {\n      this.decisions.push({\n        tradeoff: this.tradeoff ? this.tradeoff : null,\n        choice: i,\n        t: Date.now()\n      })\n\n      if (this.tradeoff) this.done[this.tradeoff.toString()] = true\n\n      if (this.decisions.length > 16) {\n        this.submit()\n        return false\n      } else {\n        while (!this.tradeoff || this.done[this.tradeoff.toString()]) {\n          // randomly choose {A vs. C}, { B vs. C} and {A&B vs. C}\n          var tradeoff = this.positive === 'positive' ? _.sample([ [8,8,0], [8,0,8], [8,8,8] ]) : _.sample([ [-8,-8,0], [-8,0,-8], [-8,-8,-8] ])\n          console.log(tradeoff)\n          this.tradeoff = _.map(tradeoff, n => {\n            console.log(n)\n            return this.positive === 'positive' ? Math.ceil(Math.random() * n) : Math.floor(Math.random() * n)\n          })\n        }\n        return {\n          tradeoff: this.tradeoff \n        }\n      }\n    }\n\n    this.loadChoice = () => {\n      var deferred = $q.defer()\n      Aspects.names().then(names => {\n        Survey.safeRandomize().then(res => {\n          aspects = names\n          responses = res\n          this.positive = Abc.getSign(responses[aspects[0]], responses[aspects[1]], responses[aspects[2]])\n          console.log(this.positive)\n          deferred.resolve(fine.choose(0))\n        })\n      })\n      return deferred.promise\n    }\n\n    this.submit = () => {\n      console.log('submit')\n      Aspects.names().then(aspects => {\n        Survey.getResponses().then(responses => {\n          User.addData('fineoverlap', {\n            date: Date.now(),\n            aspects: aspects,\n            responses: responses,\n            decisions: this.decisions\n          })\n        })\n      })\n    }\n    return fine\n  })\n  .controller('AbacCtrl', function ($scope, Choices, Abac, Slide, $location) {\n    $scope.choice = {}\n    $scope.choices = Choices\n\n    Abac.loadChoice().then(choice => {\n      $scope.choice = choice\n    })\n\n    $scope.choose = function (i) {\n      $scope.choice = Abac.choose(i)\n      Slide('.options', 300)\n    }\n\n    // the last choice returns false\n    $scope.$watch('choice', function (c) {\n      $scope.choices = Choices\n      $scope.completed = Choices.step++ / 9\n      if (!c) {\n        $location.path('overlap/abc')\n      }\n    })\n  })\n  .controller('AbcCtrl', function ($scope, Overlap, Abc, $location, Slide, Two, Abac, Choices, $timeout) {\n    $scope.overlap = Overlap\n    $scope.abc = Abc\n    $scope.choice = true\n    $scope.animate = {\n      one: false,\n      two: false\n    }\n\n    var reanimate = () => {\n      $scope.animate.one = $scope.animate.two = false\n      $timeout(() => $scope.animate.one = true, 1)\n      $timeout(() => $scope.animate.two = true, 3000)\n    }\n\n    if (Overlap.preamble) {\n      Abc.loadChoice().then(choice => {\n        $scope.choice = choice\n        reanimate()\n      })\n    }\n\n    $scope.hidePreamble = () => {\n      Overlap.preamble = true\n      setTimeout(() => {\n        Abc.loadChoice().then(choice => {\n          $scope.choice = choice\n          reanimate()\n        })\n      }, 1)\n    }\n\n    $scope.choose = function (i) {\n      $scope.choice = Abc.choose(i)\n      Slide('.options', 300)\n      reanimate()\n    }\n\n    $scope.$watch('choice', function (c) {\n      $scope.choices = Choices\n      $scope.completed = Choices.step++ / 9\n      if (!c) {\n        Overlap.submit()\n        $location.path('overlap/exit')\n      }\n    })\n  })\n  .controller('FineCtrl', function ($scope, Overlap, Fine, $location, Slide, Two, Abac, Choices, $timeout) {\n    $scope.overlap = Overlap\n    $scope.choice = true\n    $scope.animate = {\n      one: false,\n      two: false\n    }\n\n    var reanimate = () => {\n      $scope.animate.one = $scope.animate.two = false\n      $timeout(() => $scope.animate.one = true, 1)\n      $timeout(() => $scope.animate.two = true, 3000)\n    }\n\n    if(Overlap.preamble) {\n      Fine.loadChoice().then(choice => {\n        $scope.choice = choice\n        reanimate()\n      })\n    }\n\n    $scope.hidePreamble = () => {\n      Overlap.preamble = true\n      setTimeout(() => {\n        Fine.loadChoice().then((choice) => {\n          $scope.choice = choice\n          reanimate()\n        })\n      }, 1)\n    }\n\n    $scope.choose = function (i) {\n      $scope.choice = Fine.choose(i)\n      Slide('.options', 300)\n      reanimate()\n    }\n\n    $scope.$watch('choice', function (c) {\n      $scope.choices = Choices\n      $scope.completed = Choices.step++ / 12\n      if (!c) {\n        Fine.submit()\n        $location.path('fineoverlap/exit')\n      }\n    })\n  })","angular.module('well.results', [])\n  .directive('sicilian', function ($window, Aspects) {\n    return {\n      restrict: 'EA',\n      scope: {\n        responses: '=',\n        weights: '='\n      },\n      link: function(scope, element, attrs) {\n        var svg = d3.select(element[0])\n          .append('svg')\n          .attr('class', 'sicilian')\n          .style('width', '100%')\n\n        svg.style('height', svg.style('width'))\n\n        window.onresize = function() {\n          scope.$apply()\n        }\n\n        scope.$watch(function() {\n          return angular.element($window)[0].innerWidth\n        }, function() {\n          scope.render()\n        })\n\n        scope.$watch('responses', function () {\n          scope.render()\n        }, true)\n\n        scope.$watch('weights', function () {\n          scope.render()\n        }, true)\n\n        var sort = null\n        attrs.$observe('sort', function (s) {\n          sort = s\n        })\n\n        var names = Aspects.names()\n        //   weights = _.map(names, function (e, i) {\n        //     return Math.random()\n        //   }),\n        //   sum = _.reduce(weights, function (a, b) {\n        //     return a + b\n        //   }),\n        //   data = _.map(names, function (e, i) {\n        //     return {\n        //       name: e,\n        //       weight: weights[i] / sum\n        //     }\n        //   })\n\n        // data = _.sortBy(data, function (d) {\n        //   return d.weight * -1\n        // })\n\n\n        scope.render = function () {\n          var data = _.map(names, function (a) {\n            return {\n              name: a,\n              weight: scope.weights[a]\n            }\n          })\n          data = _.sortBy(data, function (d) {\n            if (sort === 'level') {\n              return scope.responses[d.name]\n            } else {\n              return d.weight * -1\n            }\n          })\n\n          svg.selectAll('*').remove()\n\n          var width = svg.style('width').replace('px','')\n\n          var g = svg.selectAll()\n              .data(data)\n            .enter().append('g')\n              .style('height', function (d) {\n                return d.weight * width\n              })\n\n          g.append('rect')\n              .attr('y', function (d) {\n                return _.reduce(data, function (a, b) {\n                  if (data.indexOf(b) >= data.indexOf(d)) {\n                    return a\n                  } else {\n                    return a + b.weight * width\n                  }\n                }, 0)\n              })\n              .attr('width', function (d) {\n                return width\n              })\n              .attr('height', function (d) {\n                return d.weight * width\n              })\n              .style('fill', function (d) {\n                return Aspects.getColor(d.name, 30)\n              })\n\n          g.append('rect')\n              .attr('y', function (d) {\n                return _.reduce(data, function (a, b) {\n                  if (data.indexOf(b) >= data.indexOf(d)) {\n                    return a\n                  } else {\n                    return a + b.weight * width\n                  }\n                }, 0)\n              })\n              .attr('width', function (d) {\n                return (scope.responses[d.name] / 100) * width\n              })\n              .attr('height', function (d) {\n                return d.weight * width\n              })\n              .style('fill', function (d) {\n                return Aspects.getColor(d.name, 140)\n              })\n\n          g.append('text')\n              .attr('class', 'weight')\n              .attr('y', function (d) {\n                return d.weight * width * 0.5 + _.reduce(data, function (a, b) {\n                  if (data.indexOf(b) >= data.indexOf(d)) {\n                    return a\n                  } else {\n                    return a + b.weight * width\n                  }\n                }, 0)\n              })\n              .attr('dy', '.5em')\n              .text(function (d) {\n                return d3.format('%')(d.weight)\n              })\n              \n        }\n      }\n    }\n  })\n  .directive('chart', function ($window, User) {\n    return {\n      restrict: 'EA',\n      scope: {\n      },\n      link: function(scope, element, attrs) {\n        var svg = d3.select(element[0]).append('svg')\n\n        window.onresize = function() {\n          scope.$apply()\n        }\n\n        scope.$watch(function() {\n          return angular.element($window)[0].innerWidth\n        }, function() {\n          if (data) scope.render()\n        })\n\n        var data\n        User.getData('threetwo').then(function (response) {\n          data = _.map(response, function (datum) {\n            var score = _.reduce(datum.aspects, function (memo, num) {\n              return memo + datum.responses[num] * datum.weights[num]\n            }, 0)\n            return {\n              score: score,\n              date: datum.date\n            }\n          })\n\n          if (data.length === 1) {\n            var before = _.clone(data[0])\n            before.date = data[0].date - 50000\n            var after = _.clone(data[0])\n            after.date = data[0].date + 50000\n            data = [before, data[0], after]\n          }\n          console.log(data)\n          scope.render()\n        })\n\n        scope.render = function () {\n          console.log(data)\n\n          svg.selectAll('*').remove()\n          var bounds = element[0].parentNode.getBoundingClientRect()\n          console.log(bounds)\n          var height = bounds.width / 3\n          var width = bounds.width\n\n          svg\n            .attr('width', width)\n            .attr('height', height)\n\n          var x = d3.time.scale()\n              .domain( [data[0].date, data[data.length - 1].date] )\n              .rangeRound([30, width - 30])\n\n          var y = d3.scale.linear()\n            .domain([0, 100])\n            .rangeRound([height - 30, 30])\n\n          var xAxis = d3.svg.axis()\n            .scale(x)\n            .orient('bottom')\n\n          var yAxis = d3.svg.axis()\n            .scale(y)\n            .orient('left')\n\n          svg.append('g')\n            .attr('class', 'x axis')\n            .attr('transform', 'translate(0, ' + Number(height - 30) + ')')\n            .call(xAxis)\n\n          svg.append('g')\n            .attr('class', 'y axis')\n            .attr('transform', 'translate(30,0)')\n            .call(yAxis)\n\n          var line = d3.svg.line()\n            .x(function(d) { return x(d.date) })\n            .y(function(d) { return y(d.score) })\n            .interpolate('basis')\n\n          svg.append('path')\n            .attr('class', 'line')\n            .datum(data)\n            .attr('d', line)\n        }\n      }\n    }\n  })\n  .controller('ExitCtrl', function ($scope, User, $location) {\n    $scope.satisfaction = {\n      level: null,\n      comments: null,\n      submitted: false,\n      submit: () => {\n        $scope.satisfaction.submitted = true\n        User.addData('feedback', {\n          t: Date.now(),\n          module: $location.path().split('/')[1],\n          level: $scope.satisfaction.level,\n          comments: $scope.satisfaction.comments\n        })\n      }\n    }\n  })","angular.module('well.instruct', [])\n  .controller('InstructorCtrl', function ($scope, Survey, $location, $timeout) {\n    \n    Survey.safeRandomize()\n\n    $scope.instructions = {\n      \n      step: 0,\n      \n      next: () => $scope.instructions.step++,\n      \n      prev: () => $scope.instructions.step--,\n      \n      repeat: () => $scope.instructions.step = $scope.instructions.choice = 0,\n\n      animOne: null,\n\n      animTwo: null,\n      \n      understood: () => {\n        switch ($location.path().split('/')[1]) {\n          case 'threetwo':\n            $location.path('threetwo/abbcca')\n            break\n          case 'overlap':\n            $location.path('overlap/abac')\n            break\n          case 'fineoverlap':\n            $location.path('fineoverlap/tradeoff')\n            break\n        }\n      }\n    \n    }\n\n    $scope.$watch('instructions.step', (step) => {\n      $scope.instructions.animOne = $scope.instructions.animTwo = null\n      if (step === 2) $timeout(() => {\n        $scope.instructions.animOne = 'one'\n      }, 2000)\n\n      if (step === 3) $timeout(() => {\n        $scope.instructions.animTwo = 'one'\n      }, 2000)\n    })\n\n  })\n  .controller('InstructCtrl', function ($scope, Survey, $interval, $timeout, Point, $location) {\n    Survey.safeRandomize()\n\n    $scope.instructions = {\n      next: () => {\n        switch ($location.path().split('/')[1]) {\n          case 'threetwo':\n            $location.path('threetwo/abbcca')\n            break\n          case 'overlap':\n            $location.path('overlap/abac')\n            break\n          case 'fineoverlap':\n            $location.path('fineoverlap/tradeoff')\n            break\n        }\n      }\n    }\n\n    $scope.delay = 6000\n    $scope.instructions.partZero = true\n    var animate = () => {\n      switch ($scope.t / $scope.delay) {\n        case 1:\n          $scope.instructions.partOne = true\n          $scope.instructions.partZero = false\n          break\n\n        case 2:\n          $scope.instructions.partTwo = true\n          $scope.instructions.diffOne = 4\n          $scope.instructions.animOne = 'one'\n          break\n\n        case 3:\n          $scope.instructions.partOne = false\n          $scope.instructions.partThree = true\n          break\n\n        case 4:\n          $scope.instructions.partFour = true\n          $scope.instructions.diffTwo = 4\n          $scope.instructions.animTwo = 'one'\n          break\n\n        case 5:\n          $scope.instructions.partThree = false\n          $scope.instructions.partFive = true\n          $scope.instructions.highlightOne = true\n          $scope.instructions.highlightTwo = true\n          Point.leftRight()\n          break\n\n        case 6:\n          $scope.animating = false\n          $interval.cancel($scope.instructions.promise)\n          $scope.instructions.highlightOne = false\n          $scope.instructions.highlightTwo = false\n          $scope.instructions.done = true\n      }\n    }\n\n    $scope.instructions.run = () => {\n      Point.hide()\n      $scope.instructions.done = false\n      $scope.instructions.partZero = true\n      $scope.instructions.partOne = false\n      $scope.instructions.partTwo = false\n      $scope.instructions.partThree = false\n      $scope.instructions.partFour = false\n      $scope.instructions.partFive = false\n      $scope.instructions.highlightOne = false\n      $scope.instructions.highlightTwo = false\n\n      $scope.instructions.diffOne = 0\n      $scope.instructions.diffTwo = 0\n\n      $scope.t = 0\n      $scope.completed = 0\n      $scope.animating = true\n\n      $scope.instructions.promise = $interval(() => {\n        if ($scope.animating) {\n          $scope.t += 10\n          $scope.completed = $scope.t / ($scope.delay * 6)\n          animate()\n        }\n      }, 10)\n    }\n\n    $scope.instructions.run()\n\n  })\n  .directive('stepper', function () {\n    return {\n      restrict: 'E',\n      scope: {\n        steps: '=',\n        parent: '='\n      },\n      templateUrl: 'stepper.html',\n      link: function (scope, element, attributes) {\n        console.log(scope.steps)\n      }\n    }\n  })\n  .factory('Point', function ($timeout) {\n    var point = this\n    var pointer = d3.select('.pointer-hand')\n\n    this.mouse = { x: 400, y: 400 }\n    document.onmousemove = (event) => {\n      this.mouse.x = event.clientY\n      this.mouse.y = event.clientX\n    }\n\n    this.isWithin = (element) => {\n      var bounds = document.querySelector(element).getBoundingClientRect()\n      var pos = document.querySelector('.pointer').getBoundingClientRect()\n      return pos.left > bounds.left && pos.left < bounds.left + bounds.width\n        && pos.top > bounds.top && pos.top < bounds.top + bounds.height\n    }\n\n    this.hide = () => {\n      pointer.style('display', 'none')\n    }\n\n    this.leftRight = () => {\n      var left = document.querySelector('.left').getBoundingClientRect()\n      var right = document.querySelector('.right').getBoundingClientRect()\n      pointer\n        .style('display', 'block')\n        .style('left', this.mouse.y  + 'px')\n        .style('top', this.mouse.x + 'px')\n        .transition()\n        .duration(2000)\n          .style('left', left.left + (left.width / 2) + 'px')\n          .style('top', left.top + (left.height / 2) + 'px')\n          .tween('position', () => {\n            return function(t) {\n              d3.select('.left').classed('hover', point.isWithin('.left'))\n              d3.select('.right').classed('hover', point.isWithin('.right'))\n            }\n          })\n          .transition()\n          .duration(1000)\n            .style('left', right.left + (right.width / 2) + 'px')\n            .style('top', right.top + (right.height / 2) + 'px')\n            .tween('position', () => {\n              return function(t) {\n                d3.select('.left').classed('hover', point.isWithin('.left'))\n                d3.select('.right').classed('hover', point.isWithin('.right'))\n              }\n            })\n            .each('end', () => {\n              d3.select('body').append('svg')\n                .attr('width', '100%')\n                .attr('height', '100%')\n                .style({\n                  position: 'fixed',\n                  top: 0,\n                  left: 0,\n                  'z-index': 999,\n                  'pointer-events': 'none'\n                })\n                .append('circle')\n                  .attr('cx', right.left + (right.width / 2))\n                  .attr('cy', right.top + (right.height / 2))\n                  .attr('r', 0)\n                  .style('fill', 'none')\n                  .style('stroke', '#000')\n                  .style('stroke-opacity', 1)\n                  .style('stroke-width', '2px')\n                  .transition()\n                  .duration(1000)\n                    .attr('r', 100)\n                    .style('stroke-opacity', 0)\n\n              d3.select('.left')\n                .style('opacity', 1)\n                .transition()\n                .duration(1000)\n                .style('opacity', 0.3)\n            })\n    }\n\n    return this\n  })","angular.module('well.admin', [])\n  .controller('AdminCtrl', function ($scope, User) {\n    User.isAdmin().then((isAdmin) => {\n      $scope.isAdmin = isAdmin\n    })\n\n    $scope.data = {\n      type: 'JSON'\n    }\n    \n    User.getAllData('threetwo').then((data) => {\n      $scope.data.threetwo = data\n    })\n\n    User.getAllData('overlap').then((data) => {\n      $scope.data.overlap = data\n    })\n\n    User.getAllData('fineoverlap').then((data) => {\n      $scope.data.fineoverlap = data\n    })\n  })\n  // .factory('Admin', function (User, $) {\n  //   this.get = (module) => {\n  //     var deferred = $q.defer()\n  //     User\n  //     return deferred.promise\n  //   }\n\n  //   return this\n  // })"],"sourceRoot":"/source/"}